{
  "Synopsis": "Reads all Group Managed Service Accounts (gMSAs) from a ntds.dit file, while deriving their current passwords from KDS root keys.",
  "Description": "As none of the required information is encrypted, the BootKey is not required. Does not work on database files from RODCs.",
  "Parameters": [
    {
      "Name": null,
      "Type": null,
      "Description": "",
      "Required": false,
      "Position": 0,
      "Aliases": null,
      "DefaultValue": null,
      "Globbing": false,
      "PipelineInput": null,
      "variableLength": false
    }
  ],
  "Notes": [
    ""
  ],
  "CommandType": "Cmdlet",
  "Component": [
    null
  ],
  "Inputs": [
    "None"
  ],
  "Outputs": [
    "DSInternals.Common.Data.GroupManagedServiceAccount"
  ],
  "Links": [
    null,
    null
  ],
  "Examples": [
    {
      "Title": "Example 1",
      "Markdown": "",
      "Code": "PS C:\\> Get-ADDBServiceAccount -DatabasePath 'C:\\ADBackup\\ntds.dit'\r\n<# Sample Output:\r\nDistinguishedName: CN=svc_adfs,CN=Managed Service Accounts,DC=contoso,DC=com\r\nSid: S-1-5-21-2468531440-3719951020-3687476655-1109\r\nGuid: 53c845f7-d9cd-471b-a364-e733641dcc86\r\nSamAccountName: svc_adfs$\r\nDescription: ADFS Service Account\r\nEnabled: True\r\nDeleted: False\r\nUserAccountControl: WorkstationAccount\r\nSupportedEncryptionTypes: RC4_HMAC, AES128_CTS_HMAC_SHA1_96, AES256_CTS_HMAC_SHA1_96\r\nServicePrincipalName: {http/login.contoso.com, host/login.contoso.com}\r\nWhenCreated: 9/9/2023 5:02:05 PM\r\nPasswordLastSet: 9/9/2023 5:02:06 PM\r\nManagedPasswordInterval: 30\r\nManagedPasswordId: RootKey=7dc95c96-fa85-183a-dff5-f70696bf0b11, Cycle=9/9/2023 10:00:00 AM (L0=361, L1=26, L2=24)\r\nManagedPasswordPreviousId:\r\nKDS Derived Secrets\r\n  NTHash: 0b5fbfb646dd7bce4f160ad69edb86ba\r\n  Kerberos Keys\r\n    AES256_CTS_HMAC_SHA1_96\r\n      Key: 5dcc418cd0a30453b267e6e5b158be4b4d80d23fd72a6ae4d5bd07f023517117\r\n      Iterations: 4096\r\n    AES128_CTS_HMAC_SHA1_96\r\n      Key: 8e1e66438a15d764ae2242eefd15e09a\r\n      Iterations: 4096\r\n#>\r\nReads all Group Managed Service Accounts (gMSAs) from the specified ntds.dit file, while deriving their current passwords from KDS root keys."
    },
    {
      "Title": "Example 2",
      "Markdown": "",
      "Code": "PS C:\\> Get-ADDBServiceAccount -EffectiveTime (Get-Date).AddMonths(1) -DatabasePath 'C:\\ADBackup\\ntds.dit'\r\nReads all Group Managed Service Accounts (gMSAs) from the specified ntds.dit file, while deriving their future passwords from KDS root keys."
    }
  ]
}