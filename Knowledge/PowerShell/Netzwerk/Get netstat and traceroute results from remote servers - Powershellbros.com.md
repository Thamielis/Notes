![netstat traceroute files](Get%20netstat%20and%20traceroute%20results%20from%20remote%20servers%20-%20Powershellbros.com/netstat-traceroute-files.png)

Today you will find out how to get netstat and traceroute results from remote machines. I often had a situation where I was asked to do some basic checks from a [network](https://www.powershellbros.com/category/networking/) perspective. Itâ€™s easy once you already have a script for that.

**Netstat and traceroute**

There are multiple ways to do network checks. I guess that most of you are probably familiar with commands like [ipconfig](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/ipconfig), [tracert](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/tracert), [netstat](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/netstat) and [ping](https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/ping). In this example, I had to combine a simple **netstat** command and PowerShell **Test-NetConnection** cmdlet with **\-Traceroute** parameter.

Please note that **Traceroute** can take a long time to complete. If you want to check multiple servers it will take few hours probably especially if URLs used for the testing purpose are inaccessible.

Below you can find a script which will run [network](https://www.powershellbros.com/tag/network/) tests on the remote machines. Here is the output in the console for a single machine:

[![netstat and traceroute](Get%20netstat%20and%20traceroute%20results%20from%20remote%20servers%20-%20Powershellbros.com/netstat-traceroute.png)](https://i1.wp.com/www.powershellbros.com/wp-content/uploads/2019/07/netstat-traceroute.png?ssl=1)

And if you want to display property:

[![netstat example](Get%20netstat%20and%20traceroute%20results%20from%20remote%20servers%20-%20Powershellbros.com/netstat-example.png)](https://i1.wp.com/www.powershellbros.com/wp-content/uploads/2019/07/netstat-example.png?ssl=1)

As you can see its difficult to read all the information in PowerShell console. This is why script will save results in **Netstat** and **Traceroute** folders on your desktop:

[![netstat and traceroute](Get%20netstat%20and%20traceroute%20results%20from%20remote%20servers%20-%20Powershellbros.com/netstat-traceroute-results.png)](https://i2.wp.com/www.powershellbros.com/wp-content/uploads/2019/07/netstat-traceroute-results.png?ssl=1)

**Final script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p><p>53</p><p>54</p><p>55</p><p>56</p><p>57</p><p>58</p><p>59</p></td><td><div><p><code>$Servers</code> <code>= </code><code>Get-Content</code> <code>"c:\users\$env:username\desktop\input.txt"</code></p><p><code>$Results</code> <code>= @()</code></p><p><code>$Results</code> <code>= </code><code>Invoke-Command</code> <code>-cn</code> <code>$Servers</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSCustomObject</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"Servername"</code> <code>-Value</code> <code>$env:computername</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"Netstat"</code> <code>-Value</code> <code>$(netstat</code> <code>-an</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Foreach</code> <code>(</code><code>$URL</code> <code>in</code> <code>$URLs</code><code>){</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ObjectProp</code> <code>= ((</code><code>$URL</code> <code>-split</code> <code>"\//"</code><code>)[1]).trim()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Trace</code> <code>= </code><code>Test-NetConnection</code> <code>$ObjectProp</code> <code>-traceroute</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>$(</code><code>$ObjectProp</code><code>)</code> <code>-Value</code> <code>$Trace</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code>$Object</code></p><p><code>} | select *</code> <code>-ExcludeProperty</code> <code>runspaceid, pscomputername,PSShowComputerName</code></p><p><code>$NetStatPath</code> <code>= </code><code>"c:\users\$env:username\desktop\netstat\"</code></p><p><code>$TracePath</code>&nbsp;&nbsp; <code>= </code><code>"c:\users\$env:username\desktop\traceroute\"</code></p><p><code>$NetFolder</code>&nbsp;&nbsp; <code>= </code><code>Test-Path</code> <code>$NetStatPath</code><code>; </code><code>if</code> <code>( </code><code>-not</code> <code>$NetFolder</code><code>)&nbsp;&nbsp; { </code><code>New-Item</code> <code>$NetStatPath</code> <code>-type</code> <code>Directory }</code></p><p><code>$TraceFolder</code> <code>= </code><code>Test-Path</code> <code>$TracePath</code><code>; </code><code>if</code> <code>( </code><code>-not</code> <code>$TraceFolder</code><code>) { </code><code>New-Item</code> <code>$TracePath</code> <code>-type</code> <code>Directory }</code></p><p><code>foreach</code> <code>(</code><code>$Item</code> <code>in</code> <code>$Results</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Properties</code> <code>= (</code><code>$item</code> <code>| </code><code>Get-Member</code> <code>-MemberType</code> <code>Properties).name | where {</code><code>$_</code> <code>-ne</code> <code>"Servername"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Foreach</code> <code>(</code><code>$p</code> <code>in</code> <code>$Properties</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code><code>(</code><code>$p</code> <code>-notmatch</code> <code>"netstat"</code><code>){</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Path</code> <code>= </code><code>$TracePath</code> <code>+ </code><code>"$($item.Servername)"</code> <code>+ </code><code>"_$($p)"</code> <code>+ </code><code>"_Traceroute.txt"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$item</code><code>.</code><code>$p</code> <code>| </code><code>Out-File</code> <code>$Path</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Else</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Path</code> <code>= </code><code>$NetStatPath</code> <code>+ </code><code>"$($item.Servername)"</code> <code>+ </code><code>"_NetStat.txt"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Item</code><code>.</code><code>$p</code> <code>| </code><code>Out-File</code> <code>$Path</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p></div></td></tr></tbody></table>