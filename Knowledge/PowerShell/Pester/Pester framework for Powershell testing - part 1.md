Today letâ€™s talk a little bit about framework for Powershel script testing called Pester.

Pester is quite fresh framework which is user friendly and very easy in implementation.  
I want to share with you basic example of using Pester commandlets.

Letâ€™s focus on three basic commands  
**Describe â€“** define name of the test group under which **Context** and **It** blocks exists.  
**Context â€“** define grouping of **It** blocks. Usually used to group specific types of test (in my example services, disk space, RAM).  
**It â€“** should be used inside of **Describe** or **Context** commands. Command included in **It** block will throw an error in case that test of command will fail. For that **Should** command is used â€“ it compare result of code in **It** block with expected result.

**Script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p></td><td><div><p><code>Describe </code><code>"Check workstation"</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Context </code><code>"Check service status"</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>It </code><code>"VSS service status - stopped"</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(</code><code>Get-Service</code> <code>-Name</code> <code>VSS).Status| Should Be Stopped</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>It </code><code>"Firewall service status - running"</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(</code><code>Get-Service</code> <code>-Name</code> <code>MpsSvc).Status| Should Be Running</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Context </code><code>"Check free disk space"</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>It </code><code>"C drive free space greater than 20 GB"</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(</code><code>Get-WmiObject</code> <code>win32_logicaldisk</code> <code>-Filter</code> <code>"Drivetype=3"</code> <code>| </code><code>Where-Object</code> <code>{</code><code>$_</code><code>.DeviceID </code><code>-eq</code> <code>"C:"</code><code>}).FreeSpace/1GB | Should BeGreaterThan 20</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>It </code><code>"D drive free space greater than 20 GB"</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(</code><code>Get-WmiObject</code> <code>win32_logicaldisk</code> <code>-Filter</code> <code>"Drivetype=3"</code> <code>| </code><code>Where-Object</code> <code>{</code><code>$_</code><code>.DeviceID </code><code>-eq</code> <code>"D:"</code><code>}).FreeSpace/1GB | Should BeGreaterThan 20</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Context </code><code>"Check RAM usage"</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>It </code><code>"Free RAM greater than 4GB"</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(</code><code>Get-Ciminstance</code> <code>Win32_OperatingSystem | </code><code>Select-Object</code> <code>FreePhysicalMemory).FreePhysicalMemory/1mb | Should BeGreaterThan 4</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p></div></td></tr></tbody></table>

**Result:**  
[![](Pester%20framework%20for%20Powershell%20testing%20-%20part%201%20-%20Powershellbros.com/Check_workstation_Pester.png)](https://i0.wp.com/www.powershellbros.com/wp-content/uploads/2017/05/Check_workstation_Pester.png)

Next part of this series will include other functionality of Pester.  
If you want to know more about Pester, go to github [Wiki](https://github.com/pester/Pester/wiki/Pester).

I hope it will be usefull for some of you ðŸ™‚  
Enjoy!