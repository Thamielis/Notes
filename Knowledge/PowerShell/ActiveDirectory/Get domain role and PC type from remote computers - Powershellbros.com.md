![](Get%20domain%20role%20and%20PC%20type%20from%20remote%20computers%20-%20Powershellbros.com/pctype-domain-role.png)

Today I want to show how to get domain role and PC type using PowerShell function. You can get this information easily using 1 liner script but results will be presented as numbers.

##### Domain role and PC type

Function is based on `Get-WmiObject` command and it query `Win32_computersystem` class. To get **“PC type”** and **“Domain Role”** using just one command we have to use `Select-Object` cmdlet after the pipeline:

<table><tbody><tr><td><p>1</p></td><td><div><p><code>Get-Wmiobject</code> <code>-Class</code> <code>‘Win32_computersystem’</code> <code>-ComputerName</code> <code>$env:computername</code> <code>| </code><code>Select-Object</code> <code>pcsystemtype,domainrole</code></p></div></td></tr></tbody></table>

Unfortunelty this command will return only numbers. We have to use `Switch` to transle it to more readable value. For example **DomainRole** property may show that a computer is a “member workstation”.

This property is inherited from `CIM_ManagedSystemElement`:

– Standalone Workstation (0)  
– Member Workstation (1)  
– Standalone Server (2)  
– Member Server (3)  
– Backup Domain Controller (4)  
– Primary Domain Controller (5)

For more information you can check [MSDN site](https://msdn.microsoft.com/en-us/library/windows/desktop/aa394102(v=vs.85).aspx).

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p></td><td><div><p><code>$Role</code> <code>= </code><code>Get-Wmiobject</code> <code>-Class</code> <code>‘Win32_computersystem’</code></p><p><code>Switch</code> <code>(</code><code>$Role</code><code>.domainrole) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"0"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Stand-alone workstation"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"1"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Member workstation"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"2"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Stand-alone server"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"3"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Member server"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"4"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Domain controller"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"5"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Pdc emulator domain controller"</code><code>}</code></p><p><code>}</code></p><p><code>$Val2</code></p></div></td></tr></tbody></table>

**How to use it?:**

<table><tbody><tr><td><p>1</p><p>2</p></td><td><div><p><code>Get-DomainRole</code> <code>-Computername</code> <code>DC01</code></p><p><code>(GC </code><code>"c:\users\$env:username\desktop\list.txt"</code><code>) | % {</code><code>Get-DomainRole</code> <code>-Computername</code> <code>$_</code><code>}</code></p></div></td></tr></tbody></table>

**Final script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p></td><td><div><p><code>Function</code> <code>Get-DomainRole</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[</code><code>CmdletBinding</code><code>()]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>param</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>(</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[</code><code>Parameter</code><code>(</code><code>Position</code><code>=0, </code><code>Mandatory</code> <code>= </code><code>$True</code><code>, </code><code>HelpMessage</code><code>=</code><code>"Provide computername"</code><code>, </code><code>ValueFromPipeline</code> <code>= </code><code>$true</code><code>)]</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Computername</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Results</code> <code>= @()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Role</code> <code>= </code><code>$Val1</code> <code>= </code><code>$Val2</code> <code>= </code><code>$Object</code> <code>= </code><code>$FQDN</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$FQDN</code> <code>= (</code><code>[System.Net.Dns]</code><code>::GetHostByName((</code><code>"$Computername"</code><code>)))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code> <code>(!</code><code>$FQDN</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Warning</code> <code>"$Computername does not exist"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Else</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Try {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Role</code> <code>= </code><code>Get-Wmiobject</code> <code>-Class</code> <code>‘Win32_computersystem’</code> <code>-ComputerName</code> <code>$Computername</code> <code>-ErrorAction</code> <code>Stop</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Catch {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Continue</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code> <code>(</code><code>$Role</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Switch</code> <code>(</code><code>$Role</code><code>.pcsystemtype) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"1"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Desktop"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"2"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Mobile / Laptop"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"3"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Workstation"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"4"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Enterprise Server"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"5"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Small Office and Home Office (SOHO) Server"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"6"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Appliance PC"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"7"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Performance Server"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"8"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val1</code> <code>= </code><code>"Maximum"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>default</code> <code>{ </code><code>$Val1</code> <code>= </code><code>"Not a known Product Type"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Switch</code> <code>(</code><code>$Role</code><code>.domainrole) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"0"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Stand-alone workstation"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"1"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Member workstation"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"2"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Stand-alone server"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"3"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Member server"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"4"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Domain controller"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"5"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code>{ </code><code>$Val2</code> <code>= </code><code>"Pdc emulator domain controller"</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSObject</code> <code>-Property</code> <code>(</code><code>[ordered]</code><code>@{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Computer&nbsp;&nbsp;&nbsp; = </code><code>$Computername</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>IPAddress&nbsp;&nbsp; = </code><code>$FQDN</code><code>.AddressList[0].IPAddressToString</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>PCType&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </code><code>$Val1</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>DomainRole&nbsp; = </code><code>$Val2</code>&nbsp;&nbsp;</p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>})</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Results</code> <code>+= </code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Return</code> <code>$Results</code></p><p><code>}</code></p></div></td></tr></tbody></table>