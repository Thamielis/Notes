Today‚Äôs short tip will be about building your first **chart report**. You can find several articles on our [blog about memory utilization](http://www.powershellbros.com/get-memory-utilization-report-using-powershell/). This time you will learn how to get results in columns chart.

##### Chart report

As some of you already know PowerShell allows you to create charts and graphs. To do this we need to use **.Net classes**. The `System.Windows.Forms.DataVisualization.Charting` namespace contains methods and properties for the Chart Windows forms control. For more information about charting class [please visit msdn site](https://msdn.microsoft.com/en-us/library/system.windows.forms.datavisualization.charting.series(v=vs.110).aspx). As you can see below I use **‚ÄúStackedBar‚Äù** chart for displaying memory report. You can check all available [ChartTypes on msdn site](https://msdn.microsoft.com/en-us/library/system.windows.forms.datavisualization.charting.seriescharttype(v=vs.110).aspx).

[![Chart Memory](PowerShell%20Tip%20of%20the%20Week%20Building%20your%20first%20chart%20report%20-%20Powershellbros.com/Chart-Memory.png)](https://i1.wp.com/www.powershellbros.com/wp-content/uploads/2018/01/Chart-Memory.png)

Chart Memory

Note: For purpose of this demonstration I just added **‚ÄúServer01‚Äù** description for every column. Final output will be saved on user desktop.

<table><tbody><tr><td><p>1</p><p>2</p></td><td><div><p><code>$Chart</code><code>.SaveImage(</code><code>$Env:USERPROFILE</code> <code>+ </code><code>"\Desktop\Chart.png"</code><code>, </code><code>"PNG"</code><code>)</code></p></div></td></tr></tbody></table>

**Memory utilization report:**  
Script is using `Get-WMIObject` command to get memory information on remote machines.

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p></td><td><div><p><code>$Servers</code> <code>= </code><code>Get-Content</code> <code>-Path</code> <code>"C:\Users\$env:username\desktop\servers.txt"</code></p><p><code>Foreach</code><code>(</code><code>$Server</code> <code>in</code> <code>$Servers</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Server</code> <code>= </code><code>$Server</code><code>.Trim()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Host</code> <code>"Processing $Server - "</code> <code>-ForegroundColor</code> <code>Green</code> <code>-NoNewLine</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ComputerMemory</code> <code>=&nbsp; </code><code>Get-WmiObject</code> <code>-Class</code> <code>WIN32_OperatingSystem</code> <code>-ComputerName</code> <code>$Server</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Memory</code> <code>= (((</code><code>$ComputerMemory</code><code>.TotalVisibleMemorySize - </code><code>$ComputerMemory</code><code>.FreePhysicalMemory)*100)/ </code><code>$ComputerMemory</code><code>.TotalVisibleMemorySize)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Memory</code></p><p><code>}</code></p></div></td></tr></tbody></table>

**Final script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p></td><td><div><p><code>$Servers</code> <code>= </code><code>Get-Content</code> <code>-Path</code> <code>"C:\Users\$env:username\desktop\servers.txt"</code></p><p><code>[void][Reflection.Assembly]</code><code>::LoadWithPartialName(</code><code>'System.Windows.Forms'</code><code>)</code></p><p><code>[void][Reflection.Assembly]</code><code>::LoadWithPartialName(</code><code>'System.Windows.Forms.DataVisualization'</code><code>)</code></p><p><code>$Chart</code> <code>= </code><code>New-Object</code> <code>-TypeName</code> <code>System.Windows.Forms.DataVisualization.Charting.Chart</code></p><p><code>$Chart</code><code>.Size = </code><code>'600,750'</code></p><p><code>$ChartArea</code> <code>= </code><code>New-Object</code> <code>-TypeName</code> <code>System.Windows.Forms.DataVisualization.Charting.ChartArea</code></p><p><code>$ChartArea</code><code>.AxisX.Title = </code><code>'Memory utilization'</code></p><p><code>$ChartArea</code><code>.AxisY.Title = </code><code>'Percentage %'</code></p><p><code>$ChartArea</code><code>.AxisX.Interval = </code><code>'1'</code></p><p><code>$ChartArea</code><code>.AxisX.LabelStyle.Enabled = </code><code>$true</code></p><p><code>$ChartArea</code><code>.AxisX.LabelStyle.Angle = 90</code></p><p><code>$Chart</code><code>.ChartAreas.Add(</code><code>$ChartArea</code><code>)</code></p><p><code>$Chart</code><code>.Series.Add(</code><code>'Memory'</code><code>)</code></p><p><code>$Chart</code><code>.Series[</code><code>'Memory'</code><code>].ChartType = </code><code>[System.Windows.Forms.DataVisualization.Charting.SeriesChartType]</code><code>::StackedBar</code></p><p><code>Foreach</code><code>(</code><code>$Server</code> <code>in</code> <code>$Servers</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Server</code> <code>= </code><code>$Server</code><code>.Trim()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Host</code> <code>"Processing $Server"</code> <code>-ForegroundColor</code> <code>Green</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ComputerMemory</code> <code>=&nbsp; </code><code>Get-WmiObject</code> <code>-Class</code> <code>WIN32_OperatingSystem</code> <code>-ComputerName</code> <code>$Server</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Memory</code> <code>= (((</code><code>$ComputerMemory</code><code>.TotalVisibleMemorySize - </code><code>$ComputerMemory</code><code>.FreePhysicalMemory)*100)/ </code><code>$ComputerMemory</code><code>.TotalVisibleMemorySize)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code><code>(</code><code>$Memory</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Value</code> <code>= </code><code>$Chart</code><code>.Series[</code><code>'Memory'</code><code>].Points.AddXY(</code><code>"$Server"</code><code>,</code><code>"$Memory"</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p><p><code>$Title</code> <code>= </code><code>New-Object</code> <code>-TypeName</code> <code>System.Windows.Forms.DataVisualization.Charting.Title</code></p><p><code>$Chart</code><code>.Titles.Add(</code><code>$Title</code><code>)</code></p><p><code>$Chart</code><code>.Titles[0].Text = </code><code>'PowerShell Bros'</code></p><p><code>$Chart</code><code>.SaveImage(</code><code>$Env:USERPROFILE</code> <code>+ </code><code>"\Desktop\Chart.png"</code><code>, </code><code>"PNG"</code><code>)</code></p></div></td></tr></tbody></table>

I hope that this was informative for you. See you in next articles üôÇ