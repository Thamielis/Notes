There are multiple ways to get IP address information. Most common are ipconfig or Get-NetIPAddress command. Today I want to show you how to check this quickly using ping class.

##### Get IP address

To check IP configuration we can use one of the following `one-liner` commands

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p></td><td><div><p><code>Ipconfig /all</code></p><p><code>$IPAddress</code> <code>= </code><code>Get-WmiObject</code> <code>Win32_NetworkAdapterConfiguration | </code><code>Where-Object</code> <code>{</code><code>$_</code><code>.Ipaddress.length </code><code>-gt</code> <code>1}</code></p><p><code>$IPAddress</code><code>.ipaddress[0]&nbsp;</code></p><p><code>Get-NetIPAddress</code> <code>-AddressState</code> <code>Preferred</code> <code>-AddressFamily</code> <code>IPv4 | </code><code>Select-Object</code> <code>IPAddress,InterfaceAlias</code></p><p><code>Get-NetIPAddress</code> <code>| </code><code>Where-Object</code> <code>{</code><code>$_</code><code>.AddressState </code><code>-eq</code> <code>"Preferred"</code><code>} | </code><code>Sort-object</code> <code>IPAddress | </code><code>Format-Table</code> <code>-Wrap</code> <code>-AutoSize</code></p><p><code>$Servers</code> <code>= </code><code>Get-Content</code> <code>-path</code> <code>"c:\users\$env:username\desktop\servers.txt"</code></p><p><code>Test-Connection</code> <code>$Servers</code> <code>-count</code> <code>1 | </code><code>Select-Object</code> <code>@{Name=</code><code>"Computername"</code><code>;Expression={</code><code>$_</code><code>.Address}},Ipv4Address</code></p></div></td></tr></tbody></table>

Our script is based on .NET Framework **System.Net.NetworkInformation** ping class:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p></td><td><div><p><code>$Server</code> <code>= </code><code>"DC01"</code></p><p><code>$ping</code> <code>= </code><code>New-Object</code> <code>System.Net.NetworkInformation.Ping</code></p><p><code>$ServerIP</code> <code>= (</code><code>$ping</code><code>.Send(</code><code>$Server</code><code>).Address)</code></p><p><code>$ping</code> <code>= </code><code>New-Object</code> <code>System.Net.NetworkInformation.Ping</code></p><p><code>Get-Content</code> <code>-path</code> <code>C:\users\</code><code>$env:username</code><code>\desktop\servers.txt | </code><code>foreach</code> <code>{ </code><code>"{0} - {1}"</code> <code>-f</code> <code>$_</code><code>, (</code><code>$ping</code><code>.Send(</code><code>$_</code><code>).Address) }</code></p></div></td></tr></tbody></table>

**Output:**  
Results will be displayed in console and at the end saved into CSV file.

[![Get IP Address](PowerShell%20Tip%20of%20the%20Week%20Get%20IP%20address%20-%20Powershellbros.com/Get-IP-Address.png)](https://i0.wp.com/www.powershellbros.com/wp-content/uploads/2017/12/Get-IP-Address.png)

Get IP Address

**Final script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p></td><td><div><p><code>$Servers</code> <code>= </code><code>Get-Content</code> <code>-path</code> <code>"c:\users\$env:username\desktop\servers.txt"</code></p><p><code>$Array</code> <code>= @()</code></p><p><code>$ping</code> <code>= </code><code>New-Object</code> <code>System.Net.NetworkInformation.Ping</code></p><p><code>Foreach</code><code>(</code><code>$Server</code> <code>in</code> <code>$Servers</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ServerIP</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Value</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ServerIP</code> <code>= (</code><code>$ping</code><code>.Send(</code><code>$Server</code><code>).Address)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code><code>(</code><code>$ServerIP</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Value</code> <code>= </code><code>$ServerIP</code><code>.IPAddressToString</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Else</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Value</code> <code>= </code><code>"(not found)"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSObject</code> <code>-Property</code> <code>(</code><code>[ordered]</code><code>@{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Server&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </code><code>$Server</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>IPAddress&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = </code><code>$Value</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>})</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Array</code> <code>+= </code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code></p><p><code>}</code></p><p><code>If</code><code>(</code><code>$Array</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Array</code> <code>| </code><code>Export-Csv</code> <code>-Path</code> <code>C:\users\</code><code>$env:username</code><code>\desktop\IPAddresses.csv</code> <code>-NoTypeInformation</code></p><p><code>}</code></p></div></td></tr></tbody></table>

If ping command doesn’t work due to some firewall limitations there is another way – `[System.Net.Dns]`

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p></td><td><div><p><code>$Server</code> <code>= </code><code>"ADFSO1"</code></p><p><code>$DNSCheck</code> <code>= (</code><code>[System.Net.Dns]</code><code>::GetHostByName((</code><code>"$Server"</code><code>)))</code></p><p><code>$IP</code> <code>= </code><code>$DNSCheck</code><code>.addresslist.ipaddresstostring</code></p></div></td></tr></tbody></table>

Using this class you can also check FQDN for server – I added article about it – [link](http://www.powershellbros.com/powershell-tip-of-the-week-get-fqdn/).