Today Iâ€™ve got for you quite easy, but very usefull script for uninstall applications on multiple machines.

Below script is using WMI objects â€“ Win32\_Product class to check if application exist on some servers.  
If it exist Uninstall method is used which uninstall applications.

As an input for script CSV file should be provided.  
It should contains two headers: **ServerName** and **ApplicationName**.

**Script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p></td><td><div><p><code>function</code> <code>Add-ArrayRow</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>param</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>(</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>[</code><code>Parameter</code><code>(</code><code>Position</code><code>=0, </code><code>Mandatory</code> <code>= </code><code>$true</code><code>, </code><code>HelpMessage</code><code>=</code><code>"Server name"</code><code>, </code><code>ValueFromPipeline</code> <code>= </code><code>$true</code><code>)]</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>$ServerName</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>[</code><code>Parameter</code><code>(</code><code>Position</code><code>=1, </code><code>Mandatory</code> <code>= </code><code>$true</code><code>, </code><code>HelpMessage</code><code>=</code><code>"Application"</code><code>, </code><code>ValueFromPipeline</code> <code>= </code><code>$true</code><code>)]</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>$Application</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSCustomObject</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"ServerName"</code> <code>-Value</code> <code>$ServerName</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"Application"</code> <code>-Value</code> <code>$Application</code></p><p><code>&nbsp;&nbsp;&nbsp;</code><code>return</code> <code>$Object</code></p><p><code>}</code></p><p><code>$CSV</code> <code>= </code><code>Import-Csv</code> <code>-Path</code> <code>&lt;your_path_to_CSV&gt;</code></p><p><code>$AppNotFound</code> <code>= @()</code></p><p><code>$AppRemoved</code> <code>= @()</code></p><p><code>$AppNotRemoved</code> <code>= @()</code></p><p><code>foreach</code><code>(</code><code>$item</code> <code>in</code> <code>$CSV</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ApplicationName</code> <code>= </code><code>$item</code><code>.applicationName</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ComputerName</code> <code>= </code><code>$item</code><code>.servername</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Row</code> <code>= </code><code>Add-ArrayRow</code> <code>-ServerName</code> <code>$ComputerName</code> <code>-Application</code> <code>$ApplicationName</code>&nbsp;&nbsp;</p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$application</code> <code>= </code><code>Get-WmiObject</code> <code>-Class</code> <code>Win32_Product</code> <code>-ComputerName</code> <code>$ComputerName</code> <code>-Filter</code> <code>"Name='$ApplicationName'"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code><code>(</code><code>$application</code> <code>-ne</code> <code>$null</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Result</code> <code>= </code><code>$application</code><code>.Uninstall()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code> <code>(</code><code>$Result</code><code>.ReturnValue </code><code>-eq</code> <code>0)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{&nbsp;&nbsp;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Verbose</code> <code>-Verbose</code> <code>"[$(Get-Date)] - $ComputerName uninstallation of $($application.name) successful!"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$AppRemoved</code> <code>+= </code><code>$Row</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Else</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{&nbsp;&nbsp;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Error</code> <code>-Verbose</code> <code>"[$(Get-Date)] - $ComputerName uninstallation of $($application.name) failed!&nbsp; Error code: $($Result.ReturnValue)"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$AppNotRemoved</code> <code>+= </code><code>$Row</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Else</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Verbose</code> <code>-Verbose</code> <code>"[$(Get-Date)] - $ComputerName does not have $ApplicationName application installed!"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$AppNotFound</code> <code>+= </code><code>$Row</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p></div></td></tr></tbody></table>

**Result:**  
[![](Uninstall%20applications%20on%20multiple%20machines%20-%20Powershellbros.com/Uninstall-application.png)](https://i0.wp.com/www.powershellbros.com/wp-content/uploads/2017/06/Uninstall-application.png)

I know itâ€™s not best solution as performance of remote connection to WMI is very slow, but it works!  
If you have solution with better performance to uninstall applications remotely, please leave a comment.

I hope it will be usefull for some of you ðŸ™‚  
Enjoy!