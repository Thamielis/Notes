Although PowerShell Cmdlets are usually written in PowerShell, there are occasions when the level of integration with existing C# or VB libraries is awkward to achieve with PowerShell. Yes, you can write Cmdlets in C# perfectly easily, but until now it has been tiresome to discover how. Now Michael Sorens shows you the simple route to writing effective C# Cmdlets.

## Contents

-   [Step 1: Create a Visual Studio project][1]
-   [Step 2: Provide a reference to .NET PowerShell resources][2]
-   [Step 3: Rename the default Class1 class to reflect your cmdlet][3]
-   [Step 4: Inherit from Cmdlet][4]
-   [Step 5: Decorate your class with CmdletAttribute][5]
-   [Step 6: Create your output container][6]
-   [Step 7: Decorate your class with OutputTypeAttribute][7]
-   [Step 8: Create your inputs][8]
-   [Step 9: Decorate your parameters with the ParameterAttribute][9]
-   [Step 10: Setup a single pipeline input][10]
-   [Step 11: Setup multiple pipeline-able properties][11]
-   [Step 12: Setup multiple inputs without the pipeline][12]
-   [Step 13: Setup inputs without accompanying parameter names][13]
-   [Step 14: Provide parameter aliases][14]
-   [Step 15: Write some production code][15]
-   [Conclusion][16]

So you really enjoy the power and flexibility you get from using PowerShell cmdlets. You have played around with writing some functions and perhaps some cmdlets in PowerShell. Now your organization wants to include a PowerShell front-end to the .NET libraries it produces, which are all developed in C#. Thus, it makes sense to write the cmdlets in C# as well, giving better integration with your build tools and unit tests… not to mention that the rest of your development team is not as versed in writing in PowerShell. This is not difficult to do; in fact, the hardest part is finding the information on how to do it… a task which you have just accomplished!

There are different ways to accomplish most significant development tasks. This one is no different.  This guide presents one way but it is certainly not the only way. In fact, you can take a short-cut around some of the things I will present: The ‘best practices’ I will describe herein are just that, but don’t discard them lightly.

The following is a complete recipe for creating a simple cmdlet, `Get-NetworkAdapter`, which reports on all the network adapters on your computer, with some filtering capabilities on different properties. Attached to this article is a complete, working solution with the implementation of the cmdlet. All the bits of code you see here come from that sample.

## Step 1: Create a Visual Studio project

Within your Visual Studio solution, you will house your cmdlets in a project, just as you would any other component you are building. For PowerShell, create a Class Library project so that once you have built the project, you have a DLL that comprises your PowerShell cmdlets.

## Step 2: Provide a reference to .NET PowerShell resources

Until recently (December, 2015) this step was tedious, vague, and wishy-washy. Now it is clean and streamlined-thanks, Microsoft, for “nuget-izing” PowerShell’s reference assemblies! Here the goal is to add a reference to `System.Management.Automation`\-the core of PowerShell-but you won’t find it if you just browse .NET assemblies. You need to use the NuGet Package Manager in Visual Studio to install the PowerShell reference assemblies first. They are available for PowerShell versions 3, 4, or 5, so choose the appropriate one for your environment. You can easily find it in the package manager by searching for “PowerShell”, as shown.

![2370-img39.jpg][fig1]

Then just select your PowerShell project created in step 1 to attach it to. Once installed, it will not only make the reference assemblies available, but it will also add just the reference you need in the project.

![2370-img3A.jpg][fig2]

## Step 3: Rename the default Class1 class to reflect your cmdlet

Rename the default `Class1` class, or create a new class if you are adding another cmdlet to the project, so that its name conforms to this format:

_<verb><noun>_Cmdlet.cs

 For this walkthrough, the cmdlet will be Get-NetworkAdapter so rename `Class1` to `GetNetworkAdapterCmdlet.cs`.

## Step 4: Inherit from Cmdlet

Instantly make your class into a cmdlet by inheriting from `System.Management.Automation.Cmdlet`:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>public</span>&nbsp;<span>class</span>&nbsp;<span>GetNetworkAdapterCmdlet</span><span>:</span>&nbsp;<span>Cmdlet</span></p><p><span>{</span></p><p><span>}</span></p></div></td></tr></tbody></table>

There are times that you may need to inherit from `PSCmdlet` instead of `Cmdlet`, but for this article Cmdlet will suffice.

## Step 5: Decorate your class with CmdletAttribute

Sadly, step 4 did not really make it a cmdlet. You also need to use `System.Management.Automation.CmdletAttribute` with appropriate arguments, namely the same verb and noun used in the class name defined in step 3. Verbs, by the way, should always come from the [list of approved verbs][17], and you should use the predefined value for it here, rather than a string constant. Nouns, on the other hand, are unconstrained, so you must supply your own string (or put it in a constant).

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>[</span><span>Cmdlet</span><span>(</span><span>VerbsCommon</span><span>.</span><span>Get</span><span>,</span>&nbsp;<span>"NetworkAdapter"</span><span>)</span><span>]</span></p><p><span>public</span>&nbsp;<span>class</span>&nbsp;<span>GetNetworkAdapterCmdlet</span><span>:</span>&nbsp;<span>Cmdlet</span></p><p><span>{</span></p><p><span>}</span></p></div></td></tr></tbody></table>

At this point, you have a cmdlet, though it does not yet do anything. To confirm that it is really a cmdlet, first build your project,  then load and examine what is in your module:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>Import-Module</span><span> </span><span>.</span><span>\</span><span>bin</span><span>\</span><span>Debug</span><span>\</span><span>PowerShellModuleInCSharp</span><span>.</span><span>dll</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-Command</span><span> </span><span>-module</span><span> </span><span>PowerShellModuleInCSharp</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>CommandType</span>&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span>&nbsp;&nbsp;<span>ModuleName</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span><span>-</span>&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>--</span><span>--</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>--</span><span>--</span><span>--</span><span>--</span><span>--</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>Cmdlet</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Get-NetworkAdapter</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>PowerShellModuleInCSharp</span></p></div></td></tr></tbody></table>

Note that the exposed name of the cmdlet comes from the `Cmdlet`, _not_ from the class name!

## Step 6: Create your output container

Inputs and outputs for your cmdlet need to be properly managed. You do _not_, for example, read from or write to the console as you would in a typical interactive program. Let’s consider outputs first. And let’s assume your cmdlet will have just one kind of output. (You can certainly have more: `Get-ChildItem`, for example, returns both `FileInfo` and `DirectoryInfo` objects.) For the sample cmdlet we are returning information about network adapters so we will simply call the output object a `NetworkAdapter`. [Windows Management Instrumentation][18], or WMI, is the library to explore your system’s resources. It returns quite a lot of properties about a network adapter; for this exercise we will just use these select few:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span></span><span>public</span>&nbsp;<span>class</span>&nbsp;<span>NetworkAdapter</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>string</span>&nbsp;<span>Name</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>string</span>&nbsp;<span>Description</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>int</span>&nbsp;<span>DeviceId</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>string</span>&nbsp;<span>Manufacturer</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>string</span>&nbsp;<span>NetConnectionId</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>bool</span>&nbsp;<span>PhysicalAdapter</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p></div></td></tr></tbody></table>

## Step 7: Decorate your class with OutputTypeAttribute

With your output object defined, you can now tell PowerShell what your cmdlet emits to the pipeline with the `System.Management.Automation.OutputType` attribute.  I have highlighted the new code in yellow here:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>[</span><span>Cmdlet</span><span>(</span><span>VerbsCommon</span><span>.</span><span>Get</span><span>,</span>&nbsp;<span>"NetworkAdapter"</span><span>)</span><span>]</span></p><p><span>[</span><span>OutputType</span><span>(</span><span>typeof</span><span>(</span><span>NetworkAdapter</span><span>)</span><span>)</span><span>]</span></p><p><span>public</span>&nbsp;<span>class</span>&nbsp;<span>GetNetworkAdapterCmdlet</span><span>:</span>&nbsp;<span>Cmdlet</span></p><p><span>{</span></p><p><span>}</span></p></div></td></tr></tbody></table>

This is important for two reasons. First, it contributes to your cmdlet’s auto-generated help text. Here is what `Get-Help` provides before and after applying the `OutputType` attribute (note the use of the `-Full` switch). Everything is the same except for the _OUTPUTS_ section, highlighted below:

<table><tbody><tr><td data-settings="hide"><div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p></div></td><td><div><p><span>&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Import-Module</span><span> </span><span>.</span><span>\</span><span>bin</span><span>\</span><span>Debug</span><span>\</span><span>PowerShellModuleInCSharp</span><span>.</span><span>dll</span><span> </span><span>-Force</span></p><p><span>&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-Help</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-full</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>NAME</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>Get-NetworkAdapter</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SYNTAX</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>Get-NetworkAdapter</span>&nbsp;<span> </span><span>[</span><span>&lt;</span><span>CommonParameters</span><span>&gt;</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>INPUTS</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>None</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>OUTPUTS</span><span> </span><span># &lt;&lt;BEFORE&gt;&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>System</span><span>.</span><span>Object</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>OUTPUTS</span><span> </span><span># &lt;&lt;AFTER&gt;&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>PowerShellModuleInCSharp</span><span>.</span><span>Containers</span><span>.</span><span>NetworkAdapter</span></p></div></td></tr></tbody></table>

Second, and perhaps more importantly, using the `OutputType` provides tab completion! Before you add the `OutputType` attribute, if you type this (the last part is “`Select-Object`“, then a space, then a tab)…

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>Import-Module</span><span> </span><span>.</span><span>\</span><span>bin</span><span>\</span><span>Debug</span><span>\</span><span>PowerShellModuleInCSharp</span><span>.</span><span>dll</span><span> </span><span>-Force</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span>&lt;</span><span>space</span><span>&gt;</span><span>&lt;</span><span>tab</span><span>&gt;</span></p></div></td></tr></tbody></table>

… nothing happens. But _after_ you apply the `OutputType` attribute, here is what happens. (As this is not a video, you need to imagine the time-lapse nature of this figure.) When you type the first line of each pair, PowerShell turns it into the second line. I have added the highlighting to draw your attention to the iteration through the list of `NetworkAdapter`‘s properties as defined above.

<table><tbody><tr><td data-settings="hide"><div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p></div></td><td><div><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Import-Module</span><span> </span><span>.</span><span>\</span><span>bin</span><span>\</span><span>Debug</span><span>\</span><span>PowerShellModuleInCSharp</span><span>.</span><span>dll</span><span> </span><span>-Force</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span>&lt;</span><span>space</span><span>&gt;</span><span>&lt;</span><span>tab</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>Description</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>Description</span><span>&lt;</span><span>tab</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>DeviceId</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>DeviceId</span><span>&lt;</span><span>tab</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>Manufacturer</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>Manufacturer</span><span>&lt;</span><span>tab</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>Name</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>Name</span><span>&lt;</span><span>tab</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>NetConnectionId</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>NetConnectionId</span><span>&lt;</span><span>tab</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>PhysicalAdapter</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>PhysicalAdapter</span><span>&lt;</span><span>tab</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>|</span><span> </span><span>Select-Object</span><span> </span><span>Description</span></p></div></td></tr></tbody></table>

The first `<tab>` activated the tab-completion, filling in the remaining portion of the first available choice lexicographically (from the set of `NetworkAdapter`‘s properties), i.e.  `Description`.

By immediately pressing `<tab>` again, you will cycle through to the next choice, `DeviceId`. If you keep pressing <tab>  it will eventually circle back to the start of the list, as shown. Note that I said the “remaining portion” just above. So if you had typed, say, “Select-Object De<tab>” then it will just fill in the first available choice beginning with “De”, namely, `Description` and cycle between Description and `DeviceId`.

## Step 8: Create your inputs

Now let’s turn our attention to the input side of things. Inputs to your cmdlet come from command-line parameters or from the pipeline or both. To provide parameters, you start with standard C# public properties. For this exercise, we will use three parameters whose names correspond to properties of the `NetworkAdapter` object defined earlier. These will be used as filters by the cmdlet. That is, if for example the `Name` parameter is supplied, the cmdlet will only return `NetworkAdapter` objects whose name matches that `Name` parameter. We will also define a fourth parameter, `MaxEntries`, which lets us throttle the number of output records we receive from the cmdlet.

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Name</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Manufacturer</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>public</span>&nbsp;<span>bool</span>&nbsp;<span>PhysicalAdapter</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>public</span>&nbsp;<span>int</span>&nbsp;<span>MaxEntries</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span><span> </span><span>=</span><span> </span>100<span>;</span></p></div></td></tr></tbody></table>

## Step 9: Decorate your parameters with the ParameterAttribute

For PowerShell to know that you want certain properties to be exposed as parameters of your cmdlet, you must add the `System.Management.Automation.ParameterAttribute`:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>[</span><span>Parameter</span><span>]</span></p><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Name</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>[</span><span>Parameter</span><span>]</span></p><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Manufacturer</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>[</span><span>Parameter</span><span>]</span></p><p><span>public</span>&nbsp;<span>bool</span>&nbsp;<span>PhysicalAdapter</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>[</span><span>Parameter</span><span>]</span></p><p><span>public</span>&nbsp;<span>int</span>&nbsp;<span>MaxEntries</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p></div></td></tr></tbody></table>

Each property decorated with the Parameter attribute becomes able to accept input as a command-line parameter. Examples:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacturer</span><span> </span><span>Microsoft</span><span> </span><span>|</span><span> </span><span>Format-Table</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacturer</span><span> </span><span>Microsoft</span><span> </span><span>-Name</span><span> </span><span>WAN</span></p></div></td></tr></tbody></table>

But this does _not_ support obtaining input _from the pipeline_. You can accept pipeline input in two different ways, covered in the next two steps.

## Step 10: Setup a single pipeline input

Say you want to be able to list all the `NetworkAdapter` objects for one or more specific manufacturers by feeding them from the pipeline:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>'Intel'</span><span>,</span><span> </span><span>'Microsoft'</span><span> </span><span>|</span><span> </span><span>Get-NetworkAdapter</span></p></div></td></tr></tbody></table>

You want to direct that pipeline input into the appropriate parameter-in this case, the Manufacturer parameter. To do this, you add the **ValueFromPipeline** argument to the `Parameter` attribute for that parameter:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>[</span><span>Parameter</span><span>(</span><span>ValueFromPipeline</span>&nbsp;<span>=</span>&nbsp;<span>true</span><span>)</span><span>]</span></p><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Manufacturer</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p></div></td></tr></tbody></table>

There’s nothing technically stopping you from applying the `ValueFromPipeline` argument to more than one parameter (say, for example, if you wanted to see whether the manufacturer _or the name_ of the network adapter contained Intel or Microsoft). But in practice, `ValueFromPipeline` is typically attached to only one parameter because there is really no need to have two parameters receiving identical values. When you do want to get multiple _different_ inputs from the pipeline, set up multiple properties as described next.

## Step 11: Setup multiple pipeline-able properties

Say you have a `NetworkAdapter` object at hand; let’s call it `$adapter1`. You want to feed `$adapter1` to `Get-NetworkAdapter` as a template, so that Get-NetworkAdapter only returns objects that match the `Name`, `Manufacturer`, and `PhysicalAdapter` values of `$adapter1`; we will choose to ignore the other properties of $adapter1 for filtering purposes.

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>$adapter1</span><span> </span><span>|</span><span> </span><span>Get-NetworkAdapter</span></p></div></td></tr></tbody></table>

Each property that we want to treat as significant must use the `ValueFromPipelineByPropertyName` argument to the `Parameter` attribute:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>[</span><span>Parameter</span><span>(</span><span>ValueFromPipelineByPropertyName</span>&nbsp;<span>=</span>&nbsp;<span>true</span><span>)</span><span>]</span></p><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Name</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>[</span><span>Parameter</span><span>(</span><span>ValueFromPipelineByPropertyName</span>&nbsp;<span>=</span>&nbsp;<span>true</span><span>,</span>&nbsp;<span>ValueFromPipeline</span>&nbsp;<span>=</span>&nbsp;<span>true</span><span>)</span><span>]</span></p><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Manufacturer</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>[</span><span>Parameter</span><span>(</span><span>ValueFromPipelineByPropertyName</span>&nbsp;<span>=</span>&nbsp;<span>true</span><span>)</span><span>]</span></p><p><span>public</span>&nbsp;<span>bool</span>&nbsp;<span>PhysicalAdapter</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p><p><span>[</span><span>Parameter</span><span>]</span></p><p><span>public</span>&nbsp;<span>int</span>&nbsp;<span>MaxEntries</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p></div></td></tr></tbody></table>

Notice that `Manufacturer` now has _two_ arguments on its `Parameter` attribute so you can still feed it an array of strings, as was done in the previous step, or you can feed an array of objects containing appropriate properties.

Let’s check our work so far. Recompile, re-import and examine the help. I’ve reduced the output to just the relevant parts here:

<table><tbody><tr><td data-settings="hide"><div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p></div></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>Import-Module</span><span> </span><span>.</span><span>\</span><span>bin</span><span>\</span><span>Debug</span><span>\</span><span>PowerShellModuleInCSharp</span><span>.</span><span>dll</span><span> </span><span>-Force</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-Help</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-full</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>NAME</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>Get-NetworkAdapter</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>SYNTAX</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>Get-NetworkAdapter</span><span> </span><span>[</span><span>-Name</span><span> </span><span>&lt;</span><span>string</span><span>&gt;</span><span>]</span><span> </span><span>[</span><span>-Manufacturer</span><span> </span><span>&lt;</span><span>string</span><span>&gt;</span><span>]</span></p><p><span>[</span><span>-PhysicalAdapter</span><span> </span><span>&lt;</span><span>bool</span><span>&gt;</span><span>]</span><span> </span><span>[</span><span>-MaxEntries</span><span> </span><span>&lt;</span><span>int</span><span>&gt;</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>PARAMETERS</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>-Manufacturer</span><span> </span><span>&lt;</span><span>string</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Accept </span><span>pipeline </span><span>input</span><span>?</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>true</span><span> </span><span>(</span><span>ByValue</span><span>,</span><span> </span><span>ByPropertyName</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>-MaxEntries</span><span> </span><span>&lt;</span><span>int</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Accept </span><span>pipeline </span><span>input</span><span>?</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>false</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>-Name</span><span> </span><span>&lt;</span><span>string</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Accept </span><span>pipeline </span><span>input</span><span>?</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>true</span><span> </span><span>(</span><span>ByPropertyName</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>-PhysicalAdapter</span><span> </span><span>&lt;</span><span>bool</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Accept </span><span>pipeline </span><span>input</span><span>?</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>true</span><span> </span><span>(</span><span>ByPropertyName</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>INPUTS</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>System</span><span>.</span><span>String</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>System</span><span>.</span><span>Boolean</span></p></div></td></tr></tbody></table>

Note that each parameter shows up in the _SYNTAX_ section, indicating its name and type. Then in the _PARAMETERS_ section, you again see the name and type of each parameter along with additional properties of the parameters-notably whether it accepts pipeline input. Finally, the _INPUTS_ section is there; not to be redundant, but to show-along with the _OUTPUTS_ section you have already seen-what data comes and goes in the pipeline. It _seems_ to be telling you that it accepts one string and one Boolean from the pipeline as inputs, but it really means that this cmdlet will accept one _or more_ strings and one _or more_ Booleans from the pipeline as input. It does _not_ reveal, as with this particular cmdlet, that, two strings and one Boolean may come from the pipeline.

Note: This is an appropriate time to mention that you have about reached the limit of the documentation PowerShell can generate from your code alone, i.e. without you having decorated your code with documentation-comments. While this documentation is useful, it is but a mere skeleton of what your documentation should be. For a practical guide to easily instrumenting your code with doc-comments, see my recent article, [Documenting Your PowerShell Binary Cmdlets][19].

## Step 12: Setup multiple inputs without the pipeline

You have seen that you can feed multiple inputs to the cmdlet like this:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>'Intel'</span><span>,</span><span> </span><span>'Microsoft'</span><span> </span><span>|</span><span> </span><span>Get-NetworkAdapter</span></p></div></td></tr></tbody></table>

That works even though the receiving parameter, `Manufacturer`, is just a simple string, _not_ a list or array!

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>[</span><span>Parameter</span><span>(</span><span>ValueFromPipelineByPropertyName</span>&nbsp;<span>=</span>&nbsp;<span>true</span><span>,</span>&nbsp;<span>ValueFromPipeline</span>&nbsp;<span>=</span>&nbsp;<span>true</span><span>)</span><span>]</span></p><p><span>public</span>&nbsp;<span>string</span>&nbsp;<span>Manufacturer</span>&nbsp;<span>{</span>&nbsp;<span>get</span><span>;</span>&nbsp;<span>set</span><span>;</span>&nbsp;<span>}</span></p></div></td></tr></tbody></table>

It works because of the nature of the pipeline: the pipeline itself handles feeding multiple values one at a time, so `Manufacturer` ever only gets asked to accept a single string at a time. But it would seem very reasonable to be able to specify multiple values to a parameter via direct parameters as well (i.e. _not_ through the pipeline):

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacturer</span><span> </span><span>Intel</span><span>,</span><span> </span><span>Microsoft</span></p></div></td></tr></tbody></table>

To do that, though, you must specify that `Manufacturer` is an array-the only change here is using `string[]` in place of `string`:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>&nbsp;&nbsp; </span><span>[</span><span>Parameter</span><span>(</span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span> </span><span>true</span><span>,</span><span> </span><span>ValueFromPipeline</span><span> </span><span>=</span><span> </span><span>true</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span>[</span><span>]</span><span> </span><span>Manufacturer</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p></div></td></tr></tbody></table>

Thus, while the commands typed by the user seem very similar, just inverted in a sense…

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>'Intel'</span><span>,</span><span> </span><span>'Microsoft'</span><span> </span><span>|</span><span> </span><span>Get-NetworkAdapter</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacturer</span><span> </span><span>Intel</span><span>,</span><span> </span><span>Microsoft</span></p></div></td></tr></tbody></table>

…internally they are handled quite differently. With the pipeline inputs, they are processed individually; the cardinality of the `Manufacturer` array is always one. With direct inputs, the cardinality of Manufacturer is the length of the array that you pass in.

## Step 13: Setup inputs without accompanying parameter names

Revisiting the last examples, we can make the parallel between pipeline and direct inputs even closer by not forcing the user to specify the name of the parameter in the latter case (i.e. “-Manufacturer” has been omitted):

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>'Intel'</span><span>,</span><span> </span><span>'Microsoft'</span><span> </span><span>|</span><span> </span><span>Get-NetworkAdapter</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>Intel</span><span>,</span><span> </span><span>Microsoft</span></p></div></td></tr></tbody></table>

To accomplish this, you need to map your cmdlet parameters to positions on the command line, so that PowerShell will know-by position alone-which parameters you are filling with values. In this case, because we assume `Manufacturer` will be wanted the most, we give that the first position, position zero. It is good practice to give _all_ your parameters position values, though, to allow the user to decide whether they want to use names at all.

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>[</span><span>Parameter</span><span>(</span><span>Position</span><span>=</span>1<span>,</span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span> </span><span>true</span><span>)</span><span>]</span></p><p><span>public</span><span> </span><span>string</span><span> </span><span>Name</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>[</span><span>Parameter</span><span>(</span><span>Position</span><span>=</span>0<span>,</span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span> </span><span>true</span><span>,</span><span> </span><span>ValueFromPipeline</span><span> </span><span>=</span><span> </span><span>true</span><span>)</span><span>]</span></p><p><span>public</span><span> </span><span>string</span><span>[</span><span>]</span><span> </span><span>Manufacturer</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>[</span><span>Parameter</span><span>(</span><span>Position</span><span>=</span>2<span>,</span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span> </span><span>true</span><span>)</span><span>]</span></p><p><span>public</span><span> </span><span>bool</span><span>?</span><span> </span><span>PhysicalAdapter</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>[</span><span>Parameter</span><span>(</span><span>Position</span><span>=</span>3<span>)</span><span>]</span></p><p><span>public</span><span> </span><span>int</span><span> </span><span>MaxEntries</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span><span> </span><span>=</span><span> </span>100<span>;</span></p></div></td></tr></tbody></table>

With these positions specified, as I’ve just demonstrated,  any of the commands below achieve precisely the same result. If you use parameter names, you can put them in any order you please, but if you want to omit names you _must_ honor the order based on the `Position` argument to each Parameter attribute:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span></span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Name</span><span> </span><span>WAN</span><span> </span><span>-PhysicalAdapter</span><span> </span><span>true</span><span> </span><span>-Manufacturer</span><span> </span><span>Intel</span></p><p><span></span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-PhysicalAdapter</span><span> </span><span>true</span>&nbsp;<span> </span><span>-Name</span><span> </span><span>WAN</span><span> </span><span>-Manufacturer</span><span> </span><span>Intel</span></p><p><span></span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacturer</span><span> </span><span>Intel</span><span> </span><span>-Name</span><span> </span><span>WAN</span><span> </span><span>-PhysicalAdapter</span><span> </span><span>true</span></p><p><span></span><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>Intel </span><span>WAN </span><span>true</span></p></div></td></tr></tbody></table>

## Step 14: Provide parameter aliases

PowerShell automatically provides prefix-parameter recognition, which is a great convenience feature: you _may_ type the entire name of a given parameter, but you are only _required_ to type enough to make it unambiguous. For example, for the `Manufacturer` parameter all of these are equivalent:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacturer</span><span> </span><span>Intel</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacture</span><span> </span><span>Intel&nbsp;&nbsp;</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufac</span><span> </span><span>Intel&nbsp;&nbsp;</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-M</span><span> </span><span>Intel</span><span>&nbsp;&nbsp;</span></p></div></td></tr></tbody></table>

That’s fine, you say, but everyone in your shop abbreviates ‘manufacturer’ as ‘mfg’. This is actually short for manufactur_ing_, but let’s run with it! Of course, ‘mfg’ is not a proper prefix of ‘manufacturer’ so that will not work by default. However, you can easily define an alias to accept an alternative name or several alternative names.  This example shows two aliases being defined.

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>&nbsp;&nbsp;</span><span>[</span><span>Parameter</span><span>(</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;<span> </span>&nbsp;<span> </span><span>Position</span><span>=</span>0<span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;<span> </span>&nbsp;<span> </span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span>&nbsp;&nbsp;</span><span>true</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;<span> </span>&nbsp;<span> </span><span>ValueFromPipeline</span><span> </span><span>=</span><span>&nbsp;&nbsp;</span><span>true</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>[</span><span>Alias</span><span>(</span><span>"mfg"</span><span>,</span><span> </span><span>"vendor"</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span>[</span><span>]</span><span> </span><span>Manufacturer</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p></div></td></tr></tbody></table>

And PowerShell provides prefix-parameter recognition on the aliases as well! So all of these are equivalent:

<table><tbody><tr><td data-settings="hide"></td><td><div><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufacturer</span><span> </span><span>Intel</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-Manufac</span><span> </span><span>Intel&nbsp;&nbsp;</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-mfg</span><span> </span><span>Intel&nbsp;&nbsp;</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-mf</span><span> </span><span>Intel</span></p><p><span>PS</span><span>&gt;</span><span> </span><span>Get-NetworkAdapter</span><span> </span><span>-vend</span><span> </span><span>Intel</span></p></div></td></tr></tbody></table>

## Step 15: Write some production code

To wrap up this short and simple (!) 15-step process to create PowerShell cmdlets in C#, let’s add just one more little detail-actual production code to do the work! To do this in your cmdlet skeleton, there are four principal methods you need to override:

-   `BeginProcessing` (to do initialization),
-   `ProcessRecord` (to process each item in the pipeline),
-   `EndProcessing` (to do finalization), and
-   `StopProcessing` (to handle abnormal termination).

Without further ado, here is the complete code for the `Get-NetworkAdapter` cmdlet. Note that this uses a bit of syntactic C# 6.0 (e.g. the amazingly useful `nameof` operator) so if you are using a Visual Studio edition prior to 2015 you will just need to substitute constant strings for those expressions. In the interests of brevity-and the fact that you are reading this article to understand how to build cmdlets, not how to report network adapter statistics!-I present the code without commentary. Take a look at the sample project attached to this article to load it up in Visual Studio and experiment with it!

<table><tbody><tr><td data-settings="hide"><div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p><p>53</p><p>54</p><p>55</p><p>56</p><p>57</p><p>58</p><p>59</p><p>60</p><p>61</p><p>62</p><p>63</p><p>64</p><p>65</p><p>66</p><p>67</p><p>68</p><p>69</p><p>70</p><p>71</p><p>72</p><p>73</p><p>74</p><p>75</p><p>76</p><p>77</p><p>78</p><p>79</p><p>80</p><p>81</p><p>82</p><p>83</p><p>84</p><p>85</p><p>86</p><p>87</p><p>88</p><p>89</p><p>90</p><p>91</p><p>92</p><p>93</p><p>94</p><p>95</p><p>96</p><p>97</p><p>98</p><p>99</p></div></td><td><div><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using </span><span>System</span><span>.</span><span>Collections</span><span>.</span><span>Generic</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using </span><span>System</span><span>.</span><span>Linq</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using </span><span>System</span><span>.</span><span>Management</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using </span><span>System</span><span>.</span><span>Management</span><span>.</span><span>Automation</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using </span><span>System</span><span>.</span><span>Text</span><span>.</span><span>RegularExpressions</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>using </span><span>PowerShellModuleInCSharp</span><span>.</span><span>Containers</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>namespace </span><span>PowerShellModuleInCSharp</span><span>.</span><span>CSharpCmdlets</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>[</span><span>Cmdlet</span><span>(</span><span>VerbsCommon</span><span>.</span><span>Get</span><span>,</span><span> </span><span>nameof</span><span>(</span><span>NetworkAdapter</span><span>)</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>[</span><span>OutputType</span><span>(</span><span>typeof</span><span>(</span><span>NetworkAdapter</span><span>)</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>public </span><span>class </span><span>GetNetworkAdapterCmdlet</span><span> </span><span>:</span><span> </span><span>Cmdlet</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>[</span><span>Parameter</span><span>(</span><span>Position</span><span>=</span>1<span>,</span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span> </span><span>true</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span> </span><span>Name</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>[</span><span>Parameter</span><span>(</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Position</span><span>=</span>0<span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span> </span><span>true</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>ValueFromPipeline</span><span> </span><span>=</span><span> </span><span>true</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>[</span><span>Alias</span><span>(</span><span>"mfg"</span><span>,</span><span> </span><span>"vendor"</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span>[</span><span>]</span><span> </span><span>Manufacturer</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>[</span><span>Parameter</span><span>(</span><span>Position</span><span>=</span>2<span>,</span><span>ValueFromPipelineByPropertyName</span><span> </span><span>=</span><span> </span><span>true</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>bool</span><span>?</span><span> </span><span>PhysicalAdapter</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>[</span><span>Parameter</span><span>(</span><span>Position</span><span>=</span>3<span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>int</span><span> </span><span>MaxEntries</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span><span> </span><span>=</span><span> </span>100<span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>private </span><span>IEnumerable</span><span>&lt;</span><span>NetworkAdapter</span><span>&gt;</span><span> </span><span>_wmiResults</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>protected </span><span>override </span><span>void </span><span>BeginProcessing</span><span>(</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>base</span><span>.</span><span>BeginProcessing</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>_wmiResults</span><span> </span><span>=</span><span> </span><span>GetWmiResults</span><span>(</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>protected </span><span>override </span><span>void </span><span>ProcessRecord</span><span>(</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>var </span><span>query</span><span> </span><span>=</span><span> </span><span>_wmiResults</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>if</span><span> </span><span>(</span><span>Name</span><span> </span><span>!=</span><span> </span><span>null</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>query</span><span> </span><span>=</span><span> </span><span>query</span><span>.</span><span>Where</span><span>(</span><span>adapter</span><span> </span><span>=</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>adapter</span><span>.</span><span>Name</span><span> </span><span>!=</span><span> </span><span>null</span><span> </span><span>&amp;&amp;</span><span> </span><span>adapter</span><span>.</span><span>Name</span><span>.</span><span>StartsWith</span><span>(</span><span>Name</span><span>)</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;<span>&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>/</span><span>/</span><span> </span><span>Just </span><span>like</span><span> </span><span>"Name"</span><span> </span><span>above</span><span>,</span><span> </span><span>this </span><span>checks </span><span>for</span><span> </span><span>prefix </span><span>matches</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>/</span><span>/</span><span> </span><span>but </span><span>on </span><span>multiple </span><span>values </span><span>instead </span><span>of </span><span>just</span><span> </span><span>a</span><span> </span><span>single</span><span> </span><span>value</span><span>.</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span>&nbsp;&nbsp;<span>if</span><span> </span><span>(</span><span>Manufacturer</span><span> </span><span>!=</span><span> </span><span>null</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>query</span><span> </span><span>=</span><span> </span><span>query</span><span>.</span><span>Where</span><span>(</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>adapter</span><span> </span><span>=</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>adapter</span><span>.</span><span>Manufacturer</span><span> </span><span>!=</span><span> </span><span>null</span><span> </span><span>&amp;&amp;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Regex</span><span>.</span><span>IsMatch</span><span>(</span><span>adapter</span><span>.</span><span>Manufacturer</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>string</span><span>.</span><span>Format</span><span>(</span><span>"^(?:{0})"</span><span>,</span><span> </span><span>string</span><span>.</span><span>Join</span><span>(</span><span>"|"</span><span>,</span><span> </span><span>Manufacturer</span><span>)</span><span>)</span><span>)</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>/</span><span>/</span><span> </span><span>Being</span><span> </span><span>a</span><span> </span><span>Boolean</span><span>,</span><span> </span><span>an </span><span>exact </span><span>match </span><span>is </span><span>used </span><span>here</span><span>.</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>if</span><span> </span><span>(</span><span>PhysicalAdapter</span><span> </span><span>!=</span><span> </span><span>null</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>query</span><span> </span><span>=</span><span> </span><span>query</span><span>.</span><span>Where</span><span>(</span><span>adapter</span><span> </span><span>=</span><span>&gt;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>adapter</span><span>.</span><span>PhysicalAdapter</span><span> </span><span>==</span><span> </span><span>PhysicalAdapter</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>query</span><span>.</span><span>Take</span><span>(</span><span>MaxEntries</span><span>)</span><span>.</span><span>ToList</span><span>(</span><span>)</span><span>.</span><span>ForEach</span><span>(</span><span>WriteObject</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>private </span><span>static </span><span>IEnumerable</span><span>&lt;</span><span>NetworkAdapter</span><span>&gt;</span><span> </span><span>GetWmiResults</span><span>(</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>const </span><span>string</span><span> </span><span>wmiQuery</span><span> </span><span>=</span><span> </span><span>"Select * from Win32_NetworkAdapter"</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>return</span><span> </span><span>new </span><span>ManagementObjectSearcher</span><span>(</span><span>wmiQuery</span><span>)</span><span>.</span><span>Get</span><span>(</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>.</span><span>Cast</span><span>&lt;</span><span>ManagementObject</span><span>&gt;</span><span>(</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>.</span><span>Select</span><span>(</span><span>BuildOutputObject</span><span>)</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>private </span><span>static </span><span>NetworkAdapter </span><span>BuildOutputObject</span><span>(</span><span>ManagementBaseObject </span><span>item</span><span>)</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>return</span><span> </span><span>new</span><span> </span><span>NetworkAdapter</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>=</span><span> </span><span>(</span><span>string</span><span>)</span><span> </span><span>item</span><span>[</span><span>nameof</span><span>(</span><span>NetworkAdapter</span><span>.</span><span>Name</span><span>)</span><span>]</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Description</span>&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>=</span><span> </span><span>(</span><span>string</span><span>)</span><span> </span><span>item</span><span>[</span><span>nameof</span><span>(</span><span>NetworkAdapter</span><span>.</span><span>Description</span><span>)</span><span>]</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>DeviceId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>=</span><span> </span><span>int</span><span>.</span><span>Parse</span><span>(</span><span>(</span><span>string</span><span>)</span><span>item</span><span>[</span><span>nameof</span><span>(</span><span>NetworkAdapter</span><span>.</span><span>DeviceId</span><span>)</span><span>]</span><span>)</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>Manufacturer</span>&nbsp;&nbsp;&nbsp;<span> </span><span>=</span><span> </span><span>(</span><span>string</span><span>)</span><span> </span><span>item</span><span>[</span><span>nameof</span><span>(</span><span>NetworkAdapter</span><span>.</span><span>Manufacturer</span><span>)</span><span>]</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>NetConnectionId</span><span> </span><span>=</span><span> </span><span>(</span><span>string</span><span>)</span><span> </span><span>item</span><span>[</span><span>nameof</span><span>(</span><span>NetworkAdapter</span><span>.</span><span>NetConnectionId</span><span>)</span><span>]</span><span>,</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>PhysicalAdapter</span><span> </span><span>=</span><span> </span><span>(</span><span>bool</span><span>)</span>&nbsp;&nbsp;<span> </span><span>item</span><span>[</span><span>nameof</span><span>(</span><span>NetworkAdapter</span><span>.</span><span>PhysicalAdapter</span><span>)</span><span>]</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span> </span><span>}</span><span>;</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>namespace </span><span>PowerShellModuleInCSharp</span><span>.</span><span>Containers</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>public</span><span> </span><span>class</span><span> </span><span>NetworkAdapter</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>{</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span> </span><span>Name</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span> </span><span>Description</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>int</span><span> </span><span>DeviceId</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span> </span><span>Manufacturer</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>string</span><span> </span><span>NetConnectionId</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp;</span><span>public</span><span> </span><span>bool</span><span> </span><span>PhysicalAdapter</span><span> </span><span>{</span><span> </span><span>get</span><span>;</span><span> </span><span>set</span><span>;</span><span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span>&nbsp;&nbsp;&nbsp;<span> </span><span>}</span></p><p><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>}</span></p></div></td></tr></tbody></table>

## Conclusion

The process of writing a PowerShell cmdlet is actually quite straightforward, though it may seem daunting the first time you go through it. Jump right in to the sample project and play with it. Use it as a model as you start on your own cmdlets. By carefully following the recipe provided in this article, you should be able to achieve what you were likely looking to do: writing a cmdlet that works in a way that a user would reasonably expect a cmdlet to work.

**Update – April 2016**  
Since this article, I’ve created a wallchart putting both XmlDoc2Cmdlet and DocTreeGenerator in context, showing you how to do a complete documentation solution for your PowerShell work in both C# and PowerShell. [Click here for more details][20]. [![2407-1-5728ddc3-433a-4b82-a6dc-84f5f450b][fig3]][21]

[fig1]: Using%20C%20to%20Create%20PowerShell%20Cmdlets%20The%20Basics%20-%20Simple%20Talk/2370-img39.jpg
[fig2]: Using%20C%20to%20Create%20PowerShell%20Cmdlets%20The%20Basics%20-%20Simple%20Talk/2370-img3A.jpg
[fig3]: Using%20C%20to%20Create%20PowerShell%20Cmdlets%20The%20Basics%20-%20Simple%20Talk/2407-1-5728ddc3-433a-4b82-a6dc-84f5f450b519.png

[1]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#first
[2]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#second
[3]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#third
[4]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#fourth
[5]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#fifth
[6]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#sixth
[7]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#seventh
[8]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#eighth
[9]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#ninth
[10]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#tenth
[11]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#eleventh
[12]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#twelveth
[13]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#thirteenth
[14]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#fourteenth
[15]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#fifteenth
[16]: https://www.red-gate.com/simple-talk/development/dotnet-development/using-c-to-create-powershell-cmdlets-the-basics/#sixteenth
[17]: https://technet.microsoft.com/en-us/library/ms714428(v=VS.85).aspx
[18]: https://msdn.microsoft.com/en-us/library/windows/desktop/aa394582(v=vs.85).aspx
[19]: https://www.simple-talk.com/dotnet/software-tools/documenting-your-powershell-binary-cmdlets/
[20]: https://www.simple-talk.com/sysadmin/powershell/unified-approach-to-generating-documentation-for-powershell-cmdlets/
[21]: https://www.simple-talk.com/sysadmin/powershell/unified-approach-to-generating-documentation-for-powershell-cmdlets/