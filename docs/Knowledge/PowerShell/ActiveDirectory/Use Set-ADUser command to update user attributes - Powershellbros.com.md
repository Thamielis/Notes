How to use **Set-ADUser** command? Updating user properties manually can be time consuming. This is why its good to have a script for bulk modifications. One of the [ActiveDirectory](https://technet.microsoft.com/en-us/library/ee617195.aspx) module command is called **Set-ADUser** and it allows us to modify user properties.

Below you can find script for adding or updating AD user mobile phone. To update phone number for one specific user we can just run the following command:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p></td><td><div><p><code>$Number</code> <code>= </code><code>"+48555666777"</code></p><p><code>Set-ADUser</code> <code>-Identity</code> <code>Pawel.Janowicz</code> <code>-MobilePhone</code> <code>$Number</code></p><p><code>Set-ADUser</code> <code>-Identity</code> <code>Pawel.Janowicz </code><code>-replace</code> <code>@{ </code><code>'MobilePhone'</code> <code>= $(</code><code>$Number</code><code>) }</code></p></div></td></tr></tbody></table>

Remember to create CSV file with two columns – “Username” and “Mobile”:

<table><tbody><tr><td><p>1</p></td><td><div><p><code>Import-CSV</code> <code>"C:\users\$env:username\Desktop\Users.csv"</code></p></div></td></tr></tbody></table>

[![CSV](Use%20Set-ADUser%20command%20to%20update%20user%20attributes%20-%20Powershellbros.com/CSV.png)](https://i2.wp.com/www.powershellbros.com/wp-content/uploads/2017/10/CSV.png)

CSV

**Final script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p></td><td><div><p><code>$UsersCSV</code> <code>= </code><code>Import-CSV</code> <code>"C:\users\$env:username\Desktop\Users.csv"</code></p><p><code>$Results</code> <code>= @()</code></p><p><code>ForEach</code> <code>(</code><code>$User</code> <code>in</code> <code>$UsersCSV</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Username</code> <code>= </code><code>$User</code><code>.username.trim()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Number</code> <code>= </code><code>$User</code><code>.mobile.trim()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$UserDetails</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$UserCheck</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Try{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$UserDetails</code> <code>= </code><code>Get-ADUser</code> <code>-Identity</code> <code>$Username</code> <code>-Properties</code> <code>MobilePhone</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Catch{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Continue</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code> <code>(!</code><code>$UserDetails</code><code>.</code><code>'MobilePhone'</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Try{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Set-ADUser</code> <code>-Identity</code> <code>$username</code> <code>-replace</code> <code>@{ </code><code>'MobilePhone'</code> <code>= $(</code><code>$Number</code><code>) }</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$UserCheck</code> <code>= </code><code>Get-ADUser</code> <code>-Identity</code> <code>$Username</code> <code>-Properties</code> <code>mobilephone</code> <code>-ErrorAction</code> <code>Stop</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code> <code>(</code><code>$UserCheck</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSObject</code> <code>-Property</code> <code>(</code><code>[ordered]</code><code>@{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"User name"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>= </code><code>$Username</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"Mobile"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>= </code><code>$UserCheck</code><code>.MobilePhone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>})</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Results</code> <code>+= </code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Catch{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Continue</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></p><p><code>}</code></p><p><code>$Results</code> <code>| </code><code>Format-Table</code></p></div></td></tr></tbody></table>

In previous articles you can find information about getting user properties – [link](http://www.powershellbros.com/powershell-one-liner-find-ad-user-based-on-property/).