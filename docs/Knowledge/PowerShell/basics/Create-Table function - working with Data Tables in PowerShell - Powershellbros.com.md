In this article, I will share with you one of the PowerShell modules I wrote for myself which I use every day for daily tasks and in my other scripts to simplify working with data and presenting them in the script or export to CSV, Excel, etc.

The module is based on .NET Framework class _‚ÄúSystem.Data‚Äù_. To create and work with a table containing a data you can use a PSObject but creating a data table using a .NET class you can modify much more settings and properties of table, column or row.

You can specify a data type for a column, for example, if you want to store a date and time in the column _‚ÄúDate‚Äù_ you do not need to present the data as a string to PSObject and re-convert this to the DateTime type if you want to reuse the data.

Using this function you can create a table of any size with columns with different data types (String, Array, DateTime, TimeSpan, etc.)

###### **Using:**

**Create-Table -TableName** {see description below} **\-ColumnNames** {see description below}

*   **TableName**: you need to provide a table name you will use later as a name of the variable that contains data table.
*   **ColumnNames**: you need to provide column names in order that you want to have it in the table, separated by a comma (‚Äú,‚Äù).  
    To set a data type for a column you need to use a ‚Äú/?‚Äù after the column name and then specify a data type.  
    Default data type is _‚ÄúString‚Äù_.

###### **Example:**

**Create-Table -TableName NameOfTheTable -ColumnNames Column1,Column2/?DataType1,Column3/?DataType2**

**Output configuration:**

*   **Column1** ‚Äì Data Type is String
*   **Column2** ‚Äì Data Type is DataType1
*   **Column3** ‚Äì Data Type is DataType2

_Tip:  
You can provide column names as a variable. (String or Array)  
(as a String): $ColumnNames = ‚ÄúColumn1,Column2/?DataType1,Column3/?DataType2‚Äù  
(as an Array): $ColumnNames = @(‚ÄúColumn1‚Ä≥,‚ÄùColumn2/?DataType1‚Ä≥,‚ÄùColumn3/?DataType2‚Äù)  
_

###### **Real life example:**

[![Create-Table](Create-Table%20function%20-%20working%20with%20Data%20Tables%20in%20PowerShell%20-%20Powershellbros.com/Create-Table.jpg "Create-Table")](https://i0.wp.com/www.powershellbros.com/wp-content/uploads/2017/08/Create-Table.jpg)

Create-Table

###### **Adding and modifying rows:**

**$NameOfTheTable.Rows.Add()** ‚Äì to add empty row  
**$NameOfTheTable.Rows.Add(ValueToColumn1,ValueToColumn2,ValueToColumn3)** ‚Äì to add the values to the table when creating the row you need to provide a values in appropriate data type separated by comma (‚Äú,‚Äù)  
**$NameOfTheTable.Rows\[0\].Column1 = ‚ÄúValueToColumn1‚Äú** ‚Äì to modify the value of Column1 in first row

###### Full code of the function/module:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p><p>53</p><p>54</p><p>55</p><p>56</p></td><td><div><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>function</code> <code>Create-Table {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>param</code><code>(</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[</code><code>Parameter</code><code>(</code><code>Mandatory</code><code>=</code><code>$true</code><code>)]</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[string]</code><code>$TableName</code><code>,</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[</code><code>Parameter</code><code>(</code><code>Mandatory</code><code>=</code><code>$true</code><code>)]</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ColumnNames</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(</code><code>$ColumnNames</code><code>.GetType().Name </code><code>-eq</code> <code>"String"</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ColumnNames</code> <code>= </code><code>$ColumnNames</code> <code>-split</code> <code>","</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>} </code><code>elseif</code> <code>(</code><code>$ColumnNames</code><code>.GetType().BaseType.Name </code><code>-ne</code> <code>"Array"</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Error</code> <code>"ColumnNames parameters accepts only String or Array value."</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>break</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$TempTable</code> <code>= </code><code>New-Object</code> <code>System.Data.DataTable</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Count</code> <code>= 0</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(</code><code>$ColumnNames</code><code>.count </code><code>-ne</code> <code>0) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>do</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Remove-Variable</code> <code>-Name</code> <code>datatype</code> <code>-ErrorAction</code> <code>SilentlyContinue</code> <code>-WarningAction</code> <code>SilentlyContinue</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$TempTable</code><code>.Columns.Add() | </code><code>Out-Null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(</code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>] </code><code>-like</code> <code>"*/?*"</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$datatype</code> <code>= </code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>].Substring(</code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>].IndexOf(</code><code>"/?"</code><code>)+2)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>] = </code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>].Substring(0,</code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>].IndexOf(</code><code>"/?"</code><code>))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>if</code> <code>(</code><code>$datatype</code> <code>-notlike</code> <code>"System.*"</code><code>) {</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$datatype</code> <code>= </code><code>"System."</code><code>+</code><code>$datatype</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$TempTable</code><code>.Columns[</code><code>$Count</code><code>].DataType = </code><code>$datatype</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$TempTable</code><code>.Columns[</code><code>$Count</code><code>].ColumnName = </code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>]</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$TempTable</code><code>.Columns[</code><code>$Count</code><code>].Caption = </code><code>$ColumnNames</code><code>[</code><code>$Count</code><code>]</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Count</code><code>++</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>} </code><code>until</code> <code>(</code><code>$Count</code> <code>-eq</code> <code>$ColumnNames</code><code>.Count)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Set-Variable</code> <code>-Name</code> <code>$TableName</code> <code>-Scope</code> <code>Global</code> <code>-Value</code> <code>(</code><code>New-Object</code> <code>System.Data.DataTable)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Set-Variable</code> <code>-Name</code> <code>$TableName</code> <code>-Scope</code> <code>Global</code> <code>-Value</code> <code>$TempTable</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Remove-Variable</code> <code>-Name</code> <code>TempTable</code> <code>-ErrorAction</code> <code>SilentlyContinue</code> <code>-WarningAction</code> <code>SilentlyContinue</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Export-ModuleMember</code> <code>-Function</code> <code>Create-Table</code></p></div></td></tr></tbody></table>

You will probably see more advanced real life usage in my next posts.  
In case you have any questions, ideas or doubts feel free to leave a comment or contact me by contact form üôÇ

I hope you enjoyed it üôÇ