![](How%20to%20add%20progress%20bar%20in%20your%20PowerShell%20scripts%20-%20Powershellbros.com/progress-bar-photo.png)

Today you will learn how to add progress bar in your code. In last post I described how to [combine CSV files](http://www.powershellbros.com/powershell-tip-of-the-week-combine-mutliple-csv-files/) and this time I’m gonna show how to use those files and add cool feature to script.

##### Progress bar

Script is based on `Write-Progress` cmdlet which displays a progress bar in a Windows PowerShell command window that depicts the status of a running command or script. You can select the indicators that the bar reflects and the text that appears above and below the progress bar. More info – [link](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-progress?view=powershell-5.1).

While running below script you will notice additional information about script progress:

[![Progress bar](How%20to%20add%20progress%20bar%20in%20your%20PowerShell%20scripts%20-%20Powershellbros.com/Progress-bar.png)](https://i0.wp.com/www.powershellbros.com/wp-content/uploads/2018/02/Progress-bar.png)

Progress bar

**Final script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p><p>53</p><p>54</p><p>55</p><p>56</p></td><td><div><p><code>$Progress</code> <code>= @{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Activity = </code><code>'Counting users in report files:'</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>CurrentOperation = </code><code>"Loading"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Status = </code><code>'Collecting data'</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>PercentComplete = 0</code></p><p><code>}</code></p><p><code>Write-Progress</code> <code>@Progress</code></p><p><code>$i</code> <code>= 0</code></p><p><code>$CSVFiles</code> <code>= </code><code>Get-ChildItem</code> <code>C:\Users\</code><code>$env:username</code><code>\Desktop\files\*.csv | </code><code>Where-Object</code> <code>{</code><code>$_</code><code>.BaseName </code><code>-match</code> <code>"User list"</code><code>}</code></p><p><code>$Array</code> <code>= @()</code></p><p><code>Foreach</code><code>(</code><code>$File</code> <code>in</code> <code>$CSVFiles</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$i</code><code>++</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>[int]</code><code>$percentage</code> <code>= (</code><code>$i</code> <code>/ </code><code>$CSVFiles</code><code>.Count)*100</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Name</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Name</code> <code>= </code><code>$file</code><code>.name</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$progress</code><code>.CurrentOperation = </code><code>"$name"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$progress</code><code>.Status = </code><code>'Processing file: '</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$progress</code><code>.PercentComplete = </code><code>$percentage</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Progress</code> <code>@Progress</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Start-Sleep</code> <code>-Milliseconds</code> <code>600</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$CSV</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Try</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$CSV</code> <code>= </code><code>import-csv</code> <code>$file</code><code>.FullName</code> <code>-ErrorAction</code> <code>Stop</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>[pscustomobject][ordered]</code> <code>@{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"Report Date"</code> <code>= </code><code>$file</code><code>.CreationTime</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"Users count"</code> <code>= (</code><code>$CSV</code><code>.samaccountname).count</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Array</code> <code>+= </code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Catch</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Warning</code> <code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Continue</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p><p><code>$Array</code> <code>= </code><code>$Array</code> <code>| </code><code>Sort-Object</code> <code>"Report date"</code> <code>-Descending</code></p><p><code>$Array</code> <code>| </code><code>Export-Csv</code> <code>-Path</code> <code>C:\users\</code><code>$env:username</code><code>\desktop\results.csv</code> <code>-NoTypeInformation</code></p></div></td></tr></tbody></table>

**Output in console ($Array):**

[![Results](How%20to%20add%20progress%20bar%20in%20your%20PowerShell%20scripts%20-%20Powershellbros.com/Results.png)](https://i2.wp.com/www.powershellbros.com/wp-content/uploads/2018/02/Results.png)

Results