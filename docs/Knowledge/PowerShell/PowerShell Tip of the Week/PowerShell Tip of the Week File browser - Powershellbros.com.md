Today’s tip will be about **file browser** in PowerShell. Its a nice feature where you can just select the server list instead of writing path inside the code.

##### File browser

To select the file we’re gonna use `System.Windows.Forms`. The System.Windows.Forms namespace contains classes for creating Windows-based applications that take full advantage of the rich user interface features available in the Microsoft Windows operating system. For more information please visit [technet site](https://technet.microsoft.com/en-us/library/system.windows.forms(v=vs.90).aspx).

In this code I used **filter** parameter to determine which type of files do I want to search:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p></td><td><div><p><code>Add-Type</code> <code>-AssemblyName</code> <code>System.Windows.Forms</code></p><p><code>$FileBrowser</code> <code>= </code><code>New-Object</code> <code>System.Windows.Forms.OpenFileDialog</code></p><p><code>$FileBrowser</code><code>.</code><code>filter</code> <code>= </code><code>"Txt (*.txt)| *.txt"</code></p><p><code>[void]</code><code>$FileBrowser</code><code>.ShowDialog()</code></p><p><code>$FileBrowser</code><code>.FileName</code></p></div></td></tr></tbody></table>

[![file browser](PowerShell%20Tip%20of%20the%20Week%20File%20browser%20-%20Powershellbros.com/file-browser.png)](https://i0.wp.com/www.powershellbros.com/wp-content/uploads/2018/01/file-browser.png)

file browser

Below you can find file browser example where you have to select servers list in txt format. Additionally script will check if server exist and run ping connectivity test against:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p></td><td><div><p><code>$Ping</code> <code>= </code><code>New-Object</code> <code>System.Net.NetworkInformation.Ping</code></p><p><code>$PingStatus</code> <code>= (</code><code>$Ping</code><code>.Send(</code><code>"$Server"</code><code>).Status)</code></p><p><code>$PingStatus</code></p><p><code>$DNSCheck</code> <code>= (</code><code>[System.Net.Dns]</code><code>::GetHostByName((</code><code>"$Server"</code><code>)))</code></p><p><code>$DNSCheck</code><code>.hostname</code></p></div></td></tr></tbody></table>

**Final script:**

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p><p>42</p><p>43</p><p>44</p><p>45</p><p>46</p><p>47</p><p>48</p><p>49</p><p>50</p><p>51</p><p>52</p><p>53</p><p>54</p><p>55</p><p>56</p><p>57</p><p>58</p><p>59</p><p>60</p><p>61</p><p>62</p><p>63</p><p>64</p><p>65</p><p>66</p><p>67</p><p>68</p><p>69</p></td><td><div><p><code>$ErrorActionPreference</code> <code>= </code><code>"Stop"</code></p><p><code>$Array</code> <code>= @()</code></p><p><code>Add-Type</code> <code>-AssemblyName</code> <code>System.Windows.Forms</code></p><p><code>$FileBrowser</code> <code>= </code><code>New-Object</code> <code>System.Windows.Forms.OpenFileDialog</code></p><p><code>$FileBrowser</code><code>.</code><code>filter</code> <code>= </code><code>"Txt (*.txt)| *.txt"</code></p><p><code>[void]</code><code>$FileBrowser</code><code>.ShowDialog()</code></p><p><code>Try</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$FilePath</code> <code>= </code><code>$FileBrowser</code><code>.FileName</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Servers</code> <code>= </code><code>Get-Content</code> <code>-Path</code> <code>$FilePath</code></p><p><code>}</code></p><p><code>Catch</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;</code><code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;</code><code>Break</code></p><p><code>}</code></p><p><code>If</code><code>( !</code><code>$Servers</code> <code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Warning</code> <code>"Something went wrong"</code></p><p><code>}</code></p><p><code>Else</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Ping</code> <code>= </code><code>New-Object</code> <code>System.Net.NetworkInformation.Ping</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Foreach</code><code>( </code><code>$Server</code> <code>in</code> <code>$Servers</code> <code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Server</code> <code>= </code><code>$Server</code><code>.Trim()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Write-Host</code> <code>Processing </code><code>$Server</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$PingStatus</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$DNSCheck</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>$null</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Try</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$DNSCheck</code> <code>= (</code><code>[System.Net.Dns]</code><code>::GetHostByName((</code><code>"$Server"</code><code>)))</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Catch</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Continue</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>If</code><code>(</code><code>$DNSCheck</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$PingStatus</code> <code>= (</code><code>$Ping</code><code>.Send(</code><code>"$Server"</code><code>).Status)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSObject</code> <code>-Property</code> <code>(</code><code>[ordered]</code><code>@{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"Server name"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>= </code><code>$DNSCheck</code><code>.hostname</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"Ping Status"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>= </code><code>$PingStatus</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>})</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Array</code> <code>+= </code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p><p><code>Write-Host</code> <code>`nFinal results:</code> <code>-ForegroundColor</code> <code>Yellow</code></p><p><code>$Array</code></p></div></td></tr></tbody></table>

[![File Browser script](PowerShell%20Tip%20of%20the%20Week%20File%20browser%20-%20Powershellbros.com/File-Browser-script.png)](https://i2.wp.com/www.powershellbros.com/wp-content/uploads/2018/01/File-Browser-script.png)

File Browser script