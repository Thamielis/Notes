![Event ID's](PowerShell%20Tip%20of%20the%20Week%20Query%20multiple%20event%20ID's%20remotely%20-%20Powershellbros.com/Event-IDs.png)

In my daily work I often need to look for specific event ID’s on all computers. As my environmnet contains mostly server core machines I always use PowerShell script for checking that.

**Multiple event ID’s**

[Get-WinEvent](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-6) cmdlet gets events from event logs, including classic logs, such as the System and Application logs, and the event logs that are generated by the Windows Event Log technology. 

It also allows you to use **filterhashtable** with the following key names:

*   LogName
*   ProviderName
*   Path
*   Keywords
*   ID
*   Level
*   StartTime
*   EndTime
*   UserID
*   Data

You can specify event ID’s and run simple command locally or remotely.

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p></td><td><div><p><code>$EventId</code> <code>= 4625,4740</code></p><p><code>Get-WinEvent</code> <code>-FilterHashTable</code> <code>@{Logname = </code><code>"ForwardedEvents"</code> <code>; ID = </code><code>$EventId</code><code>}</code></p><p><code>Get-WinEvent</code> <code>-Computername</code> <code>ADFS01</code> <code>-FilterHashTable</code> <code>@{Logname = </code><code>"ForwardedEvents"</code> <code>; ID = </code><code>$EventId</code><code>}</code></p></div></td></tr></tbody></table>

You can add few more parameters in filter like **star**t and **end** time.

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p></td><td><div><p><code>$Filter</code> <code>= @{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Logname = </code><code>'System'</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>ID = 9,5719</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>StartTime =&nbsp; </code><code>[datetime]</code><code>::Today.AddDays(-1)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>EndTime = </code><code>[datetime]</code><code>::Today</code></p><p><code>}</code></p><p><code>Get-WinEvent</code> <code>-FilterHashtable</code> <code>$Filter</code></p></div></td></tr></tbody></table>

![](PowerShell%20Tip%20of%20the%20Week%20Query%20multiple%20event%20ID's%20remotely%20-%20Powershellbros.com/Events-filter.png)

In this example I was looking for [events](https://www.powershellbros.com/tag/eventlog/) 238, 246, 247, 305, 306, 353 in **ADFS** log from last 5 days. Results will be opened in new window as after the pipeline I used [Out-GridView](https://www.powershellbros.com/using-out-gridview-with-passthru-parameter-to-select-multiple-objects/) :

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p></td><td><div><p><code>$Servers</code> <code>= </code><code>Get-Content</code> <code>"d:\scripts\servers.txt"</code></p><p><code>Invoke-Command</code> <code>$Servers</code> <code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Filter</code> <code>= @{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>ProviderName = </code><code>'AD FS'</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>ID = 238,246,247,305,306,353</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>StartTime =&nbsp; </code><code>[datetime]</code><code>::Today.AddDays(-5)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>EndTime = </code><code>[datetime]</code><code>::Today</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Get-WinEvent</code> <code>-FilterHashtable</code> <code>$Filter</code></p><p><code>} | </code><code>Select-Object</code> <code>MachineName,TimeCreated,ID,Message | </code><code>Out-GridView</code> <code>-Title</code> <code>"Results"</code>&nbsp;</p></div></td></tr></tbody></table>