![Quick Test-NetConnection](PowerShell%20Tip%20of%20the%20Week%20Quick%20connection%20test%20on%20remote%20machines%20-%20Powershellbros.com/Quick-Test-NetConnection.png)

I’m often asked how to quickly test connectivity on remote machines. In this short article from [PowerShell tip of the week](https://www.powershellbros.com/category/tip-of-the-week/) series, I wanted to share such script with you. I hope that it can be useful for some of you.

**Quick connection test**

Basically, the script is based on **[Test-NetConnection](https://www.powershellbros.com/tag/test-netconnection/)** command. I running it inside single **[Invoke-Command](https://www.powershellbros.com/?s=invoke-command)** script block. The **[Invoke-Command](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/invoke-command?view=powershell-6)** cmdlet runs commands on a local or remote computer and returns all output from the commands, including errors. By using a single **Invoke-Command** command, you can run commands on multiple computers.

[![test connection table](PowerShell%20Tip%20of%20the%20Week%20Quick%20connection%20test%20on%20remote%20machines%20-%20Powershellbros.com/Test-NetConnection-table-1.png)](https://i2.wp.com/www.powershellbros.com/wp-content/uploads/2019/07/Test-NetConnection-table-1.png?ssl=1)

**Final script:**

**Test-NetConnetion** with **\-InformationLevel** set to **Quiet**. This just returns only **True** or **False** result:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p></td><td><div><p><code>&nbsp;&nbsp;&nbsp; </code><code>Try{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code>$Array</code> &nbsp; &nbsp; &nbsp;<code>= @()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code>$Servers</code> &nbsp; &nbsp;<code>= </code><code>Get-Content</code> <code>"c:\users\$env:username\desktop\servers.txt"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code>$PortNumber</code> <code>= </code><code>'80'</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code>$Array</code> <code>= </code><code>Invoke-Command</code> <code>-cn</code> <code>$Servers</code> <code>{</code><code>param</code><code>(</code><code>$PortNumber</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Destinations</code> <code>= </code><code>"test1.powershellbros.com"</code><code>,</code><code>"test2.powershellbros.com"</code> &nbsp;</p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSCustomObject</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"Servername"</code> <code>-Value</code> <code>$env:computername</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"Port"</code> <code>-Value</code> <code>$PortNumber</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>Foreach</code> <code>(</code><code>$Item</code> <code>in</code> <code>$Destinations</code><code>){</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Result</code> <code>= </code><code>Test-NetConnection</code> <code>-Port</code> <code>$PortNumber</code> <code>-cn</code> <code>$Item</code> <code>-InformationLevel</code> <code>Quiet</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-Type</code> <code>NoteProperty</code> <code>-Name</code> &nbsp;<code>"Destination"</code> <code>-Value</code> <code>$Item</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-Type</code> <code>NoteProperty</code> <code>-Name</code> &nbsp;<code>"Connection"</code> <code>-Value</code> <code>$Result</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>}&nbsp;</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code>}</code> <code>-ArgumentList</code> <code>$PortNumber</code> <code>-ErrorAction</code> <code>stop | select *</code> <code>-ExcludeProperty</code> <code>runspaceid, pscomputername,PSShowComputerName</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>Catch </code><code>[System.Exception]</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</code><code>Write-host</code> <code>"Error"</code> <code>-backgroundcolor</code> <code>red</code> <code>-foregroundcolor</code> <code>yellow</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>$Array</code> <code>| </code><code>Out-GridView</code> <code>-Title</code> <code>"Results"</code>&nbsp;</p><p><code>&nbsp;&nbsp;&nbsp; </code><code>$Array</code> <code>| </code><code>Export-Csv</code> <code>$env:userprofile</code><code>\desktop\results.csv</code> <code>-Force</code> <code>-NoTypeInformation</code>&nbsp;</p></div></td></tr></tbody></table>

Or a more detailed version with Ping Time, Ping and TCP values:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p></td><td><div><p><code>&nbsp;&nbsp;&nbsp; </code><code>Try{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code>$Array</code> &nbsp; &nbsp; &nbsp;<code>= @()</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code>$Servers</code> &nbsp; &nbsp;<code>= </code><code>Get-Content</code> <code>"c:\users\$env:username\desktop\servers.txt"</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code>$PortNumber</code> <code>= </code><code>'80'</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code>$Array</code> <code>= </code><code>Invoke-Command</code> <code>-cn</code> <code>$Servers</code> <code>{</code><code>param</code><code>(</code><code>$PortNumber</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Destinations</code> <code>= </code><code>"test1.powershellbros.com"</code><code>,</code><code>"test2.powershellbros.com"</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>= </code><code>New-Object</code> <code>PSCustomObject</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"Servername"</code> <code>-Value</code> <code>$env:computername</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-MemberType</code> <code>NoteProperty</code> <code>-Name</code> <code>"Port"</code> <code>-Value</code> <code>$PortNumber</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>Foreach</code> <code>(</code><code>$Item</code> <code>in</code> <code>$Destinations</code><code>){</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Result</code> <code>= </code><code>Test-NetConnection</code> <code>-Port</code> <code>$PortNumber</code> <code>-cn</code> <code>$Item</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Delay</code> <code>= </code><code>$Result</code><code>.</code><code>'PingReplyDetails'</code><code>.Roundtriptime | % {(</code><code>"$_"</code> &nbsp;<code>+ </code><code>" ms"</code><code>)}</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-Type</code> <code>NoteProperty</code> <code>-Name</code> &nbsp;<code>"Destination"</code> <code>-Value</code> <code>$Item</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-Type</code> <code>NoteProperty</code> <code>-Name</code> &nbsp;<code>"Ping Time"</code> <code>-Value</code> <code>$Delay</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-Type</code> <code>NoteProperty</code> <code>-Name</code> &nbsp;<code>"Ping"</code> <code>-Value</code> <code>$Result</code><code>.PingSucceeded</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>$Object</code> <code>| </code><code>Add-Member</code> <code>-Type</code> <code>NoteProperty</code> <code>-Name</code> &nbsp;<code>"TCP"</code> <code>-Value</code> <code>$Result</code><code>.TcpTestSucceeded</code> <code>-Force</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code><code>}&nbsp;</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code>}</code> <code>-ArgumentList</code> <code>$PortNumber</code> <code>-ErrorAction</code> <code>stop | select *</code> <code>-ExcludeProperty</code> <code>runspaceid, pscomputername,PSShowComputerName</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>Catch </code><code>[System.Exception]</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;</code><code>Write-host</code> <code>"Error"</code> <code>-backgroundcolor</code> <code>red</code> <code>-foregroundcolor</code> <code>yellow</code></p><p><code>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; </code><code>$_</code><code>.Exception.Message</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp; </code><code>$Array</code> <code>| </code><code>Out-GridView</code> <code>-Title</code> <code>"Results"</code>&nbsp;</p><p><code>&nbsp;&nbsp;&nbsp; </code><code>$Array</code> <code>| </code><code>Export-Csv</code> <code>$env:userprofile</code><code>\desktop\results.csv</code> <code>-Force</code> <code>-NoTypeInformation</code>&nbsp;</p></div></td></tr></tbody></table>