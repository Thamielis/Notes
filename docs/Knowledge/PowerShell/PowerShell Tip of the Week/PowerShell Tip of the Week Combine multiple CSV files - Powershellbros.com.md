Recently I had to combine multiple files and count unique users from them. Script is pretty simple but it might me useful in some troubleshooting sessions. Below you can find two examples about how can this be done.

##### Combine CSV files

I created folder called **Files** on my desktop and pasted there user lists in CSV format. Files contains multiple columns but I was focusing only on **Samaccountname**:

[![CSV files](PowerShell%20Tip%20of%20the%20Week%20Combine%20multiple%20CSV%20files%20-%20Powershellbros.com/CSV-files.png)](https://i1.wp.com/www.powershellbros.com/wp-content/uploads/2018/02/CSV-files.png)

CSV files

File example â€“ Samaccountname column:

[![file example](PowerShell%20Tip%20of%20the%20Week%20Combine%20multiple%20CSV%20files%20-%20Powershellbros.com/file-example.png)](https://i0.wp.com/www.powershellbros.com/wp-content/uploads/2018/02/file-example.png)

file example

To select all of the CSV files from source location I used `Get-ChildItem` command and limited to **\*.csv**. Next I looped each file and select group unique users:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p></td><td><div><p><code>$CSVPath</code> <code>= </code><code>'C:\Users\$env:username\Desktop\files'</code></p><p><code>Get-ChildItem</code> <code>$log_path</code> <code>-Recurse</code> <code>-Include</code> <code>*.csv |</code></p><p><code>where-object</code> <code>{</code><code>$_</code><code>.BaseName </code><code>-match</code> <code>"User list"</code><code>} |</code></p><p><code>ForEach-Object</code> <code>{ </code><code>Import-CSV</code> <code>$_</code><code>.FullName } |</code></p><p><code>ForEach-Object</code> <code>{</code><code>$_</code><code>.</code><code>'Samaccountname'</code><code>} | </code><code>Group-Object</code> <code>|</code></p><p><code>Select-Object</code> <code>Name</code>&nbsp; <code>-Unique</code> <code>| </code><code>Sort-Object</code> <code>Name |</code></p><p><code>Export-Csv</code> <code>-Path</code> <code>"C:\Users\$env:username\Desktop\Files\Results.csv"</code> <code>-NoTypeInformation</code> <code>-Force</code></p><p><code>$Results</code> <code>= </code><code>Import-CSV</code> <code>"C:\Users\$env:username\Desktop\Files\Results.csv"</code></p><p><code>(</code><code>$Results</code><code>.name).count</code></p><p><code>(</code><code>$Results</code> <code>| select *</code> <code>-Unique</code><code>).count</code></p></div></td></tr></tbody></table>

Below you can find another way to do that using **PSCustomObject** and add it to **Array**:

<table><tbody><tr><td><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p></td><td><div><p><code>$CSVPath</code> <code>= </code><code>"C:\Users\$env:username\Desktop\files"</code></p><p><code>$AllCSVs</code> <code>= </code><code>Get-ChildItem</code> <code>$CSVPath</code> <code>-Recurse</code> <code>-Include</code> <code>*.csv | </code><code>Where-Object</code> <code>{</code><code>$_</code><code>.BaseName </code><code>-match</code> <code>"User list"</code><code>}</code></p><p><code>$Array</code> <code>= @()</code></p><p><code>Foreach</code><code>(</code><code>$File</code> <code>in</code> <code>$AllCSVs</code><code>)</code></p><p><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$CSV</code> <code>= </code><code>Import-Csv</code> <code>$file</code><code>.FullName</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>Foreach</code><code>(</code><code>$item</code> <code>in</code> <code>$CSV</code><code>)</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Object</code> <code>= </code><code>[pscustomobject][ordered]</code> <code>@{</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>"User"</code> <code>= </code><code>$item</code><code>.SamAccountName</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code>$Array</code> <code>+= </code><code>$Object</code></p><p><code>&nbsp;&nbsp;&nbsp;&nbsp;</code><code>}</code></p><p><code>}</code></p><p><code>(</code><code>$Array</code> <code>| </code><code>Select-Object</code> <code>*</code> <code>-Unique</code><code>).count</code></p></div></td></tr></tbody></table>